<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>SecureShop - Premium E-commerce Platform</title>
    <link rel="stylesheet" href="css/style.css" id="main-css" />
    <script>
      // Cache busting for development - inject before page loads
      (function() {
        const hostname = window.location.hostname
        const isLocal = hostname === 'localhost' || hostname === '127.0.0.1'
        if (isLocal) {
          const timestamp = Date.now()
          const cssLink = document.getElementById('main-css')
          if (cssLink && !cssLink.href.includes('?')) {
            cssLink.href = cssLink.href + '?v=' + timestamp
          }
        }
      })()
    </script>
  </head>
  <body>
    <div class="container">
      <header class="site-header">
        <div class="header-content">
          <div class="logo">
            <h1>üõí SecureShop</h1>
            <span class="tagline">Premium E-commerce Platform</span>
          </div>
        </div>
      </header>

      <!-- Lab Navigation Row (Top Row) -->
      <div class="nav-buttons-row">
        <div class="header-content">
          <a href="http://localhost:3000" class="nav-button back-button" id="back-button" aria-label="Back to Labs">‚Üê Back to Labs</a>
          <a href="http://localhost:9006" class="nav-button c2-button" id="view-stolen-button" target="_blank" aria-label="View Stolen Data">üïµÔ∏è View Stolen Data</a>
          <a href="http://localhost:3000/lab-03-writeup" class="nav-button writeup-button" id="writeup-button" target="_blank" aria-label="Lab Writeup">üìñ Writeup</a>
        </div>
      </div>

      <!-- Fake Website Navigation Row (Second Row) -->
      <nav class="site-nav">
        <div class="header-content">
          <a href="#" class="site-nav-link">Products</a>
          <a href="#" class="site-nav-link">Account</a>
          <a href="#" class="site-nav-link">Support</a>
          <a href="#" class="site-nav-link active">Checkout</a>
        </div>
      </nav>

      <main class="main-content">
        <div class="checkout-container">
          <div class="checkout-header">
            <h2>Secure Checkout</h2>
            <p class="security-notice">üîí Your information is protected by advanced encryption</p>
          </div>

          <div class="checkout-content">
            <div class="checkout-forms">
              <!-- Customer Information Form -->
              <section class="form-section">
                <h3>Customer Information</h3>
                <form id="customer-form" class="checkout-form">
                  <div class="form-row">
                    <div class="form-group">
                      <label for="firstName">First Name *</label>
                      <input type="text" id="firstName" name="firstName" required aria-label="First Name" />
                    </div>
                    <div class="form-group">
                      <label for="lastName">Last Name *</label>
                      <input type="text" id="lastName" name="lastName" required aria-label="Last Name"/>
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="email">Email Address *</label>
                    <input type="email" id="email" name="email" required aria-label="Email Address"/>
                  </div>
                  <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" name="phone" aria-label="Phone Number"/>
                  </div>
                </form>
              </section>

              <!-- Shipping Address Form -->
              <section class="form-section">
                <h3>Shipping Address</h3>
                <form id="shipping-form" class="checkout-form">
                  <div class="form-group">
                    <label for="address1">Street Address *</label>
                    <input type="text" id="address1" name="address1" required aria-label="Street Address" />
                  </div>
                  <div class="form-group">
                    <label for="address2">Apartment, Suite, etc.</label>
                    <input type="text" id="address2" name="address2" aria-label="Apartment, Suite, Etc"/>
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="city">City *</label>
                      <input type="text" id="city" name="city" required aria-label="City"/>
                    </div>
                    <div class="form-group">
                      <label for="state">State *</label>
                      <select id="state" name="state" required aria-label="State">
                        <option value="">Select State</option>
                        <option value="CA">California</option>
                        <option value="NY">New York</option>
                        <option value="TX">Texas</option>
                        <option value="FL">Florida</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="zip">ZIP Code *</label>
                      <input type="text" id="zip" name="zip" required aria-label="Zip Code" />
                    </div>
                  </div>
                </form>
              </section>

              <!-- Payment Information Form -->
              <section class="form-section payment-section">
                <h3>Payment Information</h3>
                <div class="payment-security">
                  <span class="security-badge">üîê SSL Secured</span>
                  <span class="accepted-cards">üí≥ Visa, MasterCard, Discover, Amex</span>
                </div>
                <form id="payment-form" class="checkout-form">
                  <div class="form-group">
                    <label for="cardNumber">Card Number *</label>
                    <input
                      type="text"
                      id="cardNumber"
                      name="cardNumber"
                      placeholder="1234 5678 9012 3456"
                      maxlength="19"
                      required
                      aria-label="Card Number"
                    />
                  </div>
                  <div class="form-row">
                    <div class="form-group">
                      <label for="expiryMonth">Expiry Month *</label>
                      <select id="expiryMonth" name="expiryMonth" required aria-label="Expiry Month">
                        <option value="">MM</option>
                        <option value="01">01</option>
                        <option value="02">02</option>
                        <option value="03">03</option>
                        <option value="04">04</option>
                        <option value="05">05</option>
                        <option value="06">06</option>
                        <option value="07">07</option>
                        <option value="08">08</option>
                        <option value="09">09</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="expiryYear">Expiry Year *</label>
                      <select id="expiryYear" name="expiryYear" required aria-label="Expiry Year">
                        <option value="">YYYY</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                        <option value="2027">2027</option>
                        <option value="2028">2028</option>
                        <option value="2029">2029</option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label for="cvv">CVV *</label>
                      <input
                        type="text"
                        id="cvv"
                        name="cvv"
                        placeholder="123"
                        maxlength="4"
                        required
                        aria-label="CVV"
                      />
                    </div>
                  </div>
                  <div class="form-group">
                    <label for="cardholderName">Cardholder Name *</label>
                    <input type="text" id="cardholderName" name="cardholderName" required aria-label="Card Holder Name"/>
                  </div>
                </form>
              </section>

              <!-- Account Creation Form -->
              <section class="form-section">
                <h3>Create Account (Optional)</h3>
                <p class="section-description">
                  Create an account to track your orders and save your information for future
                  purchases.
                </p>
                <form id="account-form" class="checkout-form">
                  <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" aria-label="Username"/>
                  </div>
                  <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" aria-label="Password"/>
                  </div>
                  <div class="form-group">
                    <label for="confirmPassword">Confirm Password</label>
                    <input type="password" id="confirmPassword" name="confirmPassword" aria-label="Confirm Password"/>
                  </div>
                  <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                      <input type="checkbox" id="newsletter" name="newsletter" aria-label="News Letter" />
                      <span class="checkmark"></span>
                      Subscribe to our newsletter for exclusive offers
                    </label>
                  </div>
                  <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                      <input type="checkbox" id="terms" name="terms" required  aria-label="Checkbox Agree"/>
                      <span class="checkmark"></span>
                      I agree to the <a href="#" class="terms-link" aria-label="Terms of Service">Terms of Service</a> and
                      <a href="#" class="terms-link" aria-label="Privacy Policy">Privacy Policy</a>
                    </label>
                  </div>
                </form>
              </section>
            </div>

            <!-- Order Summary -->
            <aside class="order-summary">
              <h3>Order Summary</h3>
              <div class="order-items">
                <div class="order-item">
                  <div class="item-info">
                    <span class="item-name">Premium Wireless Headphones</span>
                    <span class="item-details">Noise Cancelling, Black</span>
                  </div>
                  <span class="item-price">$299.99</span>
                </div>
                <div class="order-item">
                  <div class="item-info">
                    <span class="item-name">Bluetooth Speaker</span>
                    <span class="item-details">Waterproof, Portable</span>
                  </div>
                  <span class="item-price">$89.99</span>
                </div>
              </div>
              <div class="order-totals">
                <div class="total-line">
                  <span>Subtotal:</span>
                  <span>$389.98</span>
                </div>
                <div class="total-line">
                  <span>Shipping:</span>
                  <span>$9.99</span>
                </div>
                <div class="total-line">
                  <span>Tax:</span>
                  <span>$31.20</span>
                </div>
                <div class="total-line total">
                  <span>Total:</span>
                  <span>$431.17</span>
                </div>
              </div>

              <div class="checkout-actions">
                <button type="button" class="btn btn-primary" id="place-order" aria-label="Place Order Button">
                  <span class="btn-text">Place Order</span>
                  <span class="btn-icon">üîí</span>
                </button>
                <p class="security-text">Your payment is secured with 256-bit SSL encryption</p>
              </div>

              <div class="trust-indicators">
                <div class="trust-badge">
                  <span class="badge-icon">üõ°Ô∏è</span>
                  <span class="badge-text">Secure Checkout</span>
                </div>
                <div class="trust-badge">
                  <span class="badge-icon">üöö</span>
                  <span class="badge-text">Free Shipping</span>
                </div>
                <div class="trust-badge">
                  <span class="badge-icon">‚Ü©Ô∏è</span>
                  <span class="badge-text">30-Day Returns</span>
                </div>
              </div>
            </aside>
          </div>
        </div>
      </main>

      <footer class="site-footer">
        <div class="footer-content">
          <p>&copy; 2024 SecureShop. All rights reserved.</p>
          <div class="footer-links">
            <a href="#">Privacy Policy</a>
            <a href="#">Terms of Service</a>
            <a href="#">Support</a>
          </div>
        </div>
      </footer>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Order Placed Successfully!</h3>
          <span class="modal-close">&times;</span>
        </div>
        <div class="modal-body">
          <div class="success-icon">‚úÖ</div>
          <p>Thank you for your purchase! Your order has been confirmed.</p>
          <p><strong>Order Number:</strong> <span id="order-number"></span></p>
          <p>You will receive a confirmation email shortly.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="closeModal()" aria-label="Continue Shopping">
            Continue Shopping
          </button>
        </div>
      </div>
    </div>

    <!-- Development: Clear Cache Button (only shows in localhost) -->
    <script>
      (function() {
        const hostname = window.location.hostname
        const isLocal = hostname === 'localhost' || hostname === '127.0.0.1'
        if (isLocal) {
          const clearCacheBtn = document.createElement('button')
          clearCacheBtn.textContent = 'üóëÔ∏è Clear Cache'
          clearCacheBtn.style.cssText = 'position:fixed;bottom:20px;right:20px;z-index:9999;padding:10px 20px;background:#dc2626;color:white;border:none;border-radius:6px;cursor:pointer;font-weight:600;box-shadow:0 4px 6px rgba(0,0,0,0.3);'
          clearCacheBtn.onclick = function() {
            if ('caches' in window) {
              caches.keys().then(names => {
                names.forEach(name => caches.delete(name))
              })
            }
            localStorage.clear()
            sessionStorage.clear()
            window.location.href = window.location.href.split('?')[0] + '?nocache=' + Date.now()
          }
          document.body.appendChild(clearCacheBtn)
        }
      })()
    </script>

    <script>
      // Cache busting for JS - must happen before script loads
      (function() {
        const hostname = window.location.hostname
        const isLocal = hostname === 'localhost' || hostname === '127.0.0.1'
        if (isLocal) {
          const timestamp = Date.now()
          const script = document.createElement('script')
          script.src = 'js/checkout-process-train.js?v=' + timestamp
          script.id = 'main-js'
          document.body.appendChild(script)
        } else {
          const script = document.createElement('script')
          script.src = 'js/checkout-process-train.js'
          script.id = 'main-js'
          document.body.appendChild(script)
        }
      })()
    </script>
    <script>
      // Environment-aware URL configuration
      ;(function () {
        const hostname = window.location.hostname
        const isLocal = hostname === 'localhost' || hostname === '127.0.0.1'

        let homeUrl, c2Url

        if (isLocal) {
          homeUrl = 'http://localhost:3000'
          c2Url = 'http://localhost:9006'
        } else if (hostname.includes('labs.stg.pcioasis.com')) {
          homeUrl = 'https://labs.stg.pcioasis.com'
          c2Url = 'https://labs.stg.pcioasis.com/03-extension-hijacking-c2'
        } else if (hostname.includes('labs.pcioasis.com')) {
          homeUrl = 'https://labs.pcioasis.com'
          c2Url = 'https://labs.pcioasis.com/03-extension-hijacking-c2'
        } else if (hostname.includes('lab-03-extension-hijacking')) {
          // Production Cloud Run
          homeUrl = 'https://labs.pcioasis.com'
          c2Url = 'https://lab-03-extension-hijacking-c2-prd-mmwwcfi5za-uc.a.run.app'
        } else {
          homeUrl = window.location.protocol + '//' + hostname
          c2Url = window.location.protocol + '//' + hostname + '/c2'
        }

        // Update lab navigation buttons
        const backButton = document.getElementById('back-button')
        const viewStolenButton = document.getElementById('view-stolen-button')
        const writeupButton = document.getElementById('writeup-button')

        if (backButton) {
          backButton.href = homeUrl
        }
        if (viewStolenButton) {
          viewStolenButton.href = c2Url
        }
        if (writeupButton) {
          writeupButton.href = writeupUrl
        }
      })()
    </script>
  </body>
</html>
