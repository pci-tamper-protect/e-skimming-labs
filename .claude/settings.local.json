{
  "permissions": {
    "allow": [
      "Bash(mcp list:*)",
      "Bash(mcp:*)",
      "Bash(curl:*)",
      "Bash(chmod:*)",
      "Bash(./run-variant-tests.sh:*)",
      "Read(//Users/kestenbroughton/projectos/**)",
      "WebSearch",
      "WebFetch(domain:www.malwarebytes.com)",
      "WebFetch(domain:threatpost.com)",
      "Bash(git init:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(lsof:*)",
      "Bash(python3:*)",
      "Bash(cat:*)",
      "Bash(ln:*)",
      "Bash(xargs:*)",
      "Bash(docker-compose up:*)",
      "Bash(docker-compose ps:*)",
      "Bash(npm test:*)",
      "Bash(docker-compose restart:*)",
      "Bash(docker-compose build:*)",
      "Bash(gh pr view:*)",
      "Bash(gh api:*)",
      "Bash(docker-compose:*)",
      "Bash(npm install)",
      "mcp__playwright__browser_snapshot",
      "mcp__playwright__browser_navigate",
      "Bash(npx playwright test:*)",
      "Bash(TEST_ENV=local npx playwright test:*)",
      "Bash(TEST_ENV=prd npx playwright test:*)",
      "WebFetch(domain:lab-01-basic-magecart-prd-mmwwcfi5za-uc.a.run.app)",
      "mcp__playwright__browser_click",
      "mcp__playwright__browser_type",
      "Bash(for file in labs/01-basic-magecart/variants/*/vulnerable-site/js/checkout*compromised.js)",
      "Bash(do)",
      "Bash(if grep -q \"localhost:9002\" \"$file\")",
      "Bash(then)",
      "Bash(echo:*)",
      "Bash(fi)",
      "Bash(done)",
      "Bash(find:*)",
      "Bash(node -e:*)",
      "Bash(docker restart:*)",
      "Bash(docker inspect:*)",
      "Bash(ls:*)",
      "Bash(grep:*)",
      "WebFetch(domain:github.com)",
      "Bash(./tests/test-traefik-routing.sh:*)",
      "Bash(timeout 60 ./tests/test-traefik-routing.sh:*)",
      "Bash(bash:*)",
      "Bash(docker exec lab1-attacker-c2 wget -q -O- http://localhost:3000/)",
      "Bash(docker exec e-skimming-labs-traefik wget -q -O- http://lab1-c2-server:3000/stolen)",
      "Bash(docker exec e-skimming-labs-home-seo wget -q -O- http://localhost:8080/)",
      "Bash(./deploy/shared-components/home-index-service/deploy-stg.sh:*)",
      "Bash(./deploy.sh:*)",
      "Bash(gcloud run services list:*)",
      "Bash(gcloud run services logs read:*)",
      "Bash(gcloud logging read:*)",
      "Bash(gcloud run services get-iam-policy:*)",
      "Bash(for service in lab-01-basic-magecart-stg lab-02-dom-skimming-stg lab-03-extension-hijacking-stg)",
      "Bash(gcloud run services add-iam-policy-binding:*)",
      "Bash(gcloud run services update:*)",
      "Bash(gcloud run services describe:*)",
      "Bash(gcloud secrets:*)",
      "Bash(ping:*)",
      "Bash(./deploy-stg.sh:*)",
      "Bash(./build-and-push.sh stg)",
      "Bash(gcloud run revisions list:*)",
      "Bash(gcloud run services update-traffic:*)",
      "Bash(gcloud auth application-default print-access-token:*)",
      "Bash(./test-local.sh)",
      "Bash(gcloud auth login:*)",
      "Bash(pkill:*)",
      "Bash(git -C /Users/kestenbroughton/projectos/e-skimming-labs status --short deploy/traefik/entrypoint.sh)",
      "Bash(git -C /Users/kestenbroughton/projectos/e-skimming-labs diff deploy/traefik/entrypoint.sh)",
      "Bash(docker build:*)",
      "Bash(docker push:*)",
      "Bash(gcloud run deploy:*)",
      "Bash(gcloud run revisions describe:*)",
      "Bash(docker exec:*)",
      "Bash(./proxy-traefik-stg.sh:*)",
      "Bash(for path in /lab1 /lab2 /lab3)",
      "Bash(do echo \"=== $path ===\")",
      "Bash(for lab in /lab1 /lab2 /lab3)",
      "Bash(do echo -n \"$lab: \")",
      "Bash(./deploy/docker-compose-auth.sh:*)",
      "Bash(docker logs:*)",
      "Bash(docker ps:*)",
      "Bash(gcloud config set:*)",
      "WebFetch(domain:plugins.traefik.io)",
      "Bash(tree:*)",
      "Bash(go get:*)",
      "Bash(go build:*)",
      "Bash(go test:*)",
      "Bash(export CLOUDRUN_PROVIDER_DEV_MODE=true)",
      "Bash(export LOG_LEVEL=DEBUG)",
      "Bash(export LOG_FORMAT=text)",
      "Bash(export ENVIRONMENT=stg)",
      "Bash(export LABS_PROJECT_ID=labs-stg)",
      "Bash(export HOME_PROJECT_ID=labs-home-stg)",
      "Bash(export REGION=us-central1)",
      "Bash(./bin/traefik-cloudrun-provider:*)",
      "Bash(export LOG_LEVEL=INFO)",
      "Bash(export LOG_FORMAT=json)",
      "Bash(go mod tidy:*)",
      "Bash(./test-e2e.sh:*)",
      "Bash(docker run:*)",
      "Bash(trufflehog git:*)",
      "Bash(docker compose ps:*)",
      "Bash(docker compose logs:*)",
      "Bash(docker compose up:*)",
      "Bash(gcloud auth print-identity-token:*)",
      "Bash(gcloud version:*)",
      "Bash(gcloud auth list:*)",
      "Bash(kill:*)",
      "Bash(gcloud auth print-access-token:*)",
      "Bash(for f in \"traefik.cloudrun.sidecar.traefik-3.0.yml\" \"dynamic/routes.yml\" \"entrypoint-sidecar.traefik-3.0.sh\" \"dashboard-entrypoint.sh\")",
      "Bash(if [ -f \"$f\" ])",
      "Bash(else)",
      "Bash(./deploy/traefik/generate-lab-labels.sh:*)",
      "Bash(source:*)",
      "Bash(get_lab_labels:*)",
      "Bash(get_lab_labels \"lab1-c2-server\")",
      "Bash(get_lab_labels \"lab2-vulnerable-site\")",
      "Bash(gcloud auth list:*)",
      "Bash(jq:*)",
      "Bash(REGION=\"us-central1\":*)",
      "Bash(LABS_PROJECT_ID=\"labs-prd\")",
      "Bash(LABS_REPOSITORY=\"e-skimming-labs\")",
      "Bash(IMAGE_TAG=\"bca7b41\")",
      "Bash(IMAGE=\"$REGION-docker.pkg.dev/$LABS_PROJECT_ID/$LABS_REPOSITORY/02-dom-skimming:$IMAGE_TAG\")",
      "Bash(ENVIRONMENT=\"prd\":*)",
      "Bash(DOMAIN_PREFIX=\"labs.pcioasis.com\")",
      "Bash(ENV_UPPER=\"PRD\":*)",
      "Bash(__NEW_LINE_9f364a959c5dd081__ LAB2_TRAEFIK_LABELS=\"traefik_enable=true,traefik_http_routers_lab2-static_rule_id=lab2-static,traefik_http_routers_lab2-static_priority=250,traefik_http_routers_lab2-static_entrypoints=web,traefik_http_routers_lab2-static_middlewares=strip-lab2-prefix-file,traefik_http_routers_lab2-static_service=lab2-vulnerable-site,traefik_http_routers_lab2-main_rule_id=lab2-main,traefik_http_routers_lab2-main_priority=200,traefik_http_routers_lab2-main_entrypoints=web,traefik_http_routers_lab2-main_middlewares=lab2-auth-check-file__strip-lab2-prefix-file,traefik_http_services_lab2-vulnerable-site_lb_port=8080\")",
      "Bash(__NEW_LINE_9f364a959c5dd081__ gcloud run deploy lab-02-dom-skimming-$ENVIRONMENT --image=$REGION-docker.pkg.dev/$LABS_PROJECT_ID/$LABS_REPOSITORY/02-dom-skimming:$IMAGE_TAG --region=$REGION --platform=managed --project=$LABS_PROJECT_ID --no-allow-unauthenticated --service-account=labs-runtime-sa@$LABS_PROJECT_ID.iam.gserviceaccount.com --port=8080 --memory=512Mi --cpu=1 --min-instances=0 --max-instances=10 --set-env-vars=\"LAB_NAME=02-dom-skimming,ENVIRONMENT=$ENVIRONMENT,DOMAIN=$DOMAIN_PREFIX,HOME_URL=https://$DOMAIN_PREFIX,C2_URL=https://$DOMAIN_PREFIX/lab2/c2\" --update-secrets=/etc/secrets/dotenvx-key=DOTENVX_KEY_$ENV_UPPER:latest --labels=\"environment=$ENVIRONMENT,lab=02-dom-skimming,project=e-skimming-labs,$LAB2_TRAEFIK_LABELS\")",
      "Bash(# Check provider sidecar logs for recent errors gcloud logging read \"\"resource.type=cloud_run_revision AND resource.labels.service_name=traefik-prd AND \\(textPayload:\\\\\"\"ERROR\\\\\"\" OR textPayload:\\\\\"\"error\\\\\"\" OR textPayload:\\\\\"\"token\\\\\"\" OR textPayload:\\\\\"\"poll\\\\\"\"\\)\"\" \\\\ --project=labs-prd --limit=20 --format=\"\"table\\(timestamp,textPayload\\)\"\")",
      "Bash(gcloud projects get-iam-policy:*)",
      "Bash(IMAGE=\"us-central1-docker.pkg.dev/labs-prd/e-skimming-labs/02-dom-skimming:nginx-fix\")",
      "Bash(# Check lab2-c2 service labels to see if it defines any conflicting routers gcloud run services describe lab2-c2-prd --region=us-central1 --project=labs-prd --format=''json\\(metadata.labels\\)'')",
      "Bash(./deploy/traefik/deploy-sidecar-traefik-3.0.sh:*)",
      "Bash(./deploy/deploy-home.sh:*)",
      "Bash(__NEW_LINE_49e2bb9f6265a697__ echo \"\")",
      "Bash(DOTENV_PRIVATE_KEY_PRD=277b6b557ce87e45dc008bbdc1dde46dfb52154d2bb4833286f38a67c230537c dotenvx get APP_FIREBASE_API_KEY -f .env.prd)",
      "Bash(DOTENV_PRIVATE_KEY_PRD=277b6b557ce87e45dc008bbdc1dde46dfb52154d2bb4833286f38a67c230537c dotenvx run -f .env.prd -- sh -c 'echo \"\"APP_FIREBASE_API_KEY=$APP_FIREBASE_API_KEY\"\" | head -c 100')",
      "Bash(DOTENV_PRIVATE_KEY=277b6b557ce87e45dc008bbdc1dde46dfb52154d2bb4833286f38a67c230537c dotenvx run -f .env.prd -- sh -c 'echo \"\"APP_FIREBASE_API_KEY=${APP_FIREBASE_API_KEY}\"\" | head -c 100')",
      "Bash(DOTENV_PRIVATE_KEY_PRD=277b6b557ce87e45dc008bbdc1dde46dfb52154d2bb4833286f38a67c230537c DOTENV_PRIVATE_KEY_PRD_SECRETS=67c921cb3a72b6846a08a1489813df6b4b8b7573ac8b1506bef168baf5bde1be dotenvx run -f .env.prd -- sh -c 'echo \"\"FIREBASE=${APP_FIREBASE_API_KEY}\"\" | cut -c1-50')",
      "Bash(dotenvx run -f .env.keys.prd -f .env.prd -- sh -c 'echo \"\"FIREBASE_KEY_LENGTH=${#APP_FIREBASE_API_KEY}\"\"')",
      "Bash(dotenvx run -f .env.keys.prd -f .env.prd -- sh -c 'echo \"\"FIREBASE=${APP_FIREBASE_API_KEY}\"\" | cut -c1-60')",
      "Bash(DOTENV_PRIVATE_KEY_PRD=277b6b557ce87e45dc008bbdc1dde46dfb52154d2bb4833286f38a67c230537c dotenvx decrypt -f .env.prd)",
      "Bash(git -C /Users/kestenbroughton/projectos/e-skimming-labs diff HEAD -- deploy/traefik/plugins-local/src/github.com/pci-tamper-protect/traefik-cloudrun-provider/provider/provider.go)",
      "Bash(git -C /Users/kestenbroughton/projectos/e-skimming-labs diff HEAD -- deploy/shared-components/home-index-service/main.go)",
      "Bash(git -C /Users/kestenbroughton/projectos/e-skimming-labs diff HEAD -- .env.prd)",
      "Bash(then echo \"=== $svc ===\" echo \"$labels\" fi done)",
      "Bash(git -C /Users/kestenbroughton/projectos/e-skimming-labs show:*)",
      "Bash(./deploy/build-deploy-all.sh:*)",
      "Bash(grep FIREBASE_API_KEY:*)",
      "Bash(head:*)",
      "Bash(docker compose:*)",
      "mcp__github_prs_issues__get_pr_content",
      "Bash(gh run:*)",
      "Bash(do:*)"
    ],
    "deny": [],
    "ask": []
  }
}
